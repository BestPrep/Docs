{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to BestPrep's Salesforce Documentation","text":"<p>This site is your central hub for understanding how BestPrep uses Salesforce to manage mentoring programs, communications, student connections, and reporting.</p> <p>Whether you're a program manager, support staff, developer, or occasional admin, you'll find everything here you need to work confidently within our Salesforce system.</p> <p>If you want to get started with understanding simply how Salesforce works and the different tools available to us, please start here: BestPrep's Salesforce System</p>"},{"location":"#purpose-of-this-site","title":"Purpose of This Site","text":"<ul> <li>Provide clear documentation on how our custom Salesforce setup works</li> <li>Share step-by-step guides for common tasks and internal tools</li> <li>Centralize reference material for fields, objects, flows, and automations</li> <li>Help new staff get oriented quickly with onboarding resources</li> </ul>"},{"location":"#structure-of-our-salesforce-system","title":"Structure of Our Salesforce System","text":"<p>BestPrep\u2019s Salesforce environment supports programs like:</p> <ul> <li>eMentors</li> <li>Cloud Coach</li> <li>Stock Market Game</li> <li>Volunteer Management</li> <li>Donor and Sponsor Tracking</li> </ul> <p>Each program is built around custom objects, flows, and automations tailored to our unique needs. This site explains what each component does \u2014 and how to safely make changes.</p>"},{"location":"#what-youll-find-here","title":"What You\u2019ll Find Here","text":""},{"location":"#getting-started","title":"Getting Started","text":"<ul> <li>Overview of key objects and relationships</li> <li>Logging in, navigating, and searching</li> <li>Understanding our custom record types</li> </ul>"},{"location":"#program-specific-guides","title":"Program-Specific Guides","text":"<ul> <li>Messaging flow (eMentors &amp; Cloud Coach)</li> <li>Teacher and mentor portals</li> <li>Managing weekly guiding questions</li> </ul>"},{"location":"#admin-dev-docs","title":"Admin + Dev Docs","text":"<ul> <li>Field reference by object</li> <li>Apex classes and triggers</li> <li>Flow logic and scheduled jobs</li> <li>Change log and deployment tips</li> </ul>"},{"location":"#common-entry-points","title":"Common Entry Points","text":"<ul> <li>Messaging Process Overview</li> </ul>"},{"location":"#need-help","title":"Need Help?","text":"<p>For questions about this portal or to suggest edits, contact Tovin Sannes-Venhuizen or email <code>tsannes-venhuizen@bestprep.org</code>.</p>"},{"location":"add_page/","title":"How to Add a New Page","text":"<p>Adding a new page to this site is easy! Follow these steps:</p>"},{"location":"add_page/#step-1-create-your-page","title":"Step 1: Create Your Page","text":"<p>All pages are written in Markdown (.md) and live in the <code>content/</code> folder.</p> <ul> <li>Ask Tovin Sannes-Venhuizen for GitHub access if you don\u2019t have it.</li> <li>Create your new <code>.md</code> file inside the correct subfolder under <code>content/</code>.</li> </ul> <p>Example: <pre><code>content/mentoring/my_new_page.md\n</code></pre></p>"},{"location":"add_page/#step-2-add-it-to-the-navigation","title":"Step 2: Add It to the Navigation","text":"<p>Open <code>mkdocs.yml</code> and add your page in the right spot under <code>nav:</code>. Here's an example:</p> <pre><code>nav:\n  - Home: index.md\n  - Add a Page: add_page.md\n  - Mentoring:\n      - Overview: mentoring/mentoring.md\n      - My New Page: mentoring/my_new_page.md\n</code></pre>"},{"location":"add_page/#step-3-rebuild-the-site","title":"Step 3: Rebuild the Site","text":"<p>After saving your edits, the site will automatically rebuild and publish (if GitHub Actions is set up). If not, notify your BestPrep Tech Admin to run:</p> <p><pre><code>mkdocs build\n</code></pre> and push the result to GitHub.</p>"},{"location":"add_page/#markdown-quick-reference","title":"Markdown Quick Reference","text":""},{"location":"add_page/#headings","title":"Headings","text":"<pre><code># H1\n## H2\n### H3\n</code></pre>"},{"location":"add_page/#emphasis","title":"Emphasis","text":"<pre><code>**Bold**   *Italic*\n</code></pre>"},{"location":"add_page/#blockquote","title":"Blockquote","text":"<pre><code>&gt; This is a quote\n</code></pre>"},{"location":"add_page/#lists","title":"Lists","text":"<p>Ordered: <pre><code>1. First\n2. Second\n</code></pre></p> <p>Unordered: <pre><code>- Item A\n- Item B\n</code></pre></p>"},{"location":"add_page/#code","title":"Code","text":"<p>Inline: `code` Block: ``` print(\"Hello World\") ```</p>"},{"location":"add_page/#links-and-images","title":"Links and Images","text":"<pre><code>[Link Title](https://example.com)\n![Alt Text](/content/images/logo.jpg)\n</code></pre>"},{"location":"add_page/#diagrams-with-mermaid","title":"Diagrams with Mermaid","text":"<p>You can add flowcharts using Mermaid like this:</p> <pre><code>&lt;div class=\"mermaid\"&gt;\nflowchart TD\n  A[Start] --&gt; B{Decision}\n  B --&gt;|Yes| C(Do it)\n  B --&gt;|No| D[Cancel]\n&lt;/div&gt;\n</code></pre>"},{"location":"add_page/#example","title":"Example:","text":"flowchart TD   A[Start] --&gt; B{Decision}   B --&gt;|Yes| C(Do it)   B --&gt;|No| X[This One is Clickable]    class X click-step-X;   classDef clickable stroke:#333,stroke-width:2px;   class X clickable;"},{"location":"add_page/#clickable-mermaid-steps-with-modals","title":"Clickable Mermaid Steps with ModalsThis is the modal header","text":"<p>Make steps clickable and open a popup:</p> <pre><code>&lt;div class=\"mermaid\"&gt; \ngraph TD\n  A[Start Flow] --&gt; X[Clickable Step]\n\n  class X click-step-X;\n\n  classDef clickable stroke:#333,stroke-width:2px;\n\n  class X clickable;\n&lt;/div&gt;\n</code></pre> <p>Then at the bottom of your page, add this modal HTML:</p> <pre><code>&lt;div id=\"modal-step-X\" class=\"custom-modal\"&gt;\n  &lt;div class=\"custom-modal-content\"&gt;\n    &lt;span class=\"custom-modal-close\" onclick=\"closeModal('modal-step-X')\"&gt;&amp;times;&lt;/span&gt;\n    &lt;h2&gt;This is the modal header&lt;/h2&gt;\n    &lt;p&gt;This is the modal body.&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre> <p>Make sure the IDs match: <code>X</code>, <code>click-step-X</code>, and <code>modal-step-X</code></p> \u00d7 <p>This is the modal body.</p>"},{"location":"contacts/","title":"BestPrep's Salesforce Contacts","text":""},{"location":"contacts/#database-administrator","title":"Database Administrator","text":"<p>Tovin Sannes-Venhuizen is BestPrep\u2019s current Database Administrator (DBA). The DBA is the primary point of contact for all Salesforce-related administration, maintenance, and oversight. This includes managing data integrity, user permissions, technical escalations, and vendor coordination.</p> <p>Contact for: - Any technical questions or support needs in Salesforce - User access and permission changes - Data correction or restoration - Escalations to RedPath (consulting partner)</p>"},{"location":"contacts/#database-assistants","title":"Database Assistants","text":"<p>Karla Bonilla and Maila Vang serve as Database Assistants and are available to support with day-to-day Salesforce data tasks.</p> <p>Contact them for: - Contact record merges - Basic data cleanup tasks - Help with non-critical, time-consuming Salesforce tasks</p>"},{"location":"contacts/#redpath-consulting-group","title":"RedPath Consulting Group","text":"<p>Our consulting partner for Salesforce is RedPath Consulting Group. </p> <p>Primary Contact: Stephanie King <code>stephanie_king@redpathcg.com</code></p> <p>Important: Only the Database Administrator is authorized to contact RedPath directly. Exceptions are limited to emergency situations where Salesforce is critically non-functional and the DBA is unreachable.</p>"},{"location":"contacts/#guidelines-reminders","title":"Guidelines &amp; Reminders","text":"<ul> <li>Never contact RedPath directly unless you have explicit approval or the situation is urgent and the DBA is unavailable.</li> <li>For everyday Salesforce help or questions, always start by submitting a BestPrep System Request (BPSR).</li> </ul> <p>For additional Salesforce process documentation and help guides, return to the home page.</p>"},{"location":"systems/","title":"Understanding Salesforce","text":"<p>Salesforce is a Customer Relationship Management (CRM) system. It stores, connects, and manages data for people, organizations, and activities. Although Salesforce may look complex, it can be understood easily by comparing it to a spreadsheet.</p>"},{"location":"systems/#comparing-salesforce-to-excel","title":"Comparing Salesforce to Excel","text":"<ul> <li>Organization (Org) \u2192 like your Excel file (<code>BestPrep.xlsx</code>). Each org has a unique 18-character ID.  </li> <li>Objects \u2192 like sheets within that file (e.g., Contacts, Cases). Custom objects end in <code>__c</code>, such as <code>BestPrepProgramParticipation__c</code>.  </li> <li>Fields \u2192 like column headers. Examples: <code>FirstName</code>, <code>LastName</code>, or <code>Email</code>.  </li> <li>Records \u2192 like rows in a sheet. Each record represents one instance of data. Example: one contact named Pippin and another named Phoebe.</li> </ul>"},{"location":"systems/#tools-within-salesforce","title":"Tools within Salesforce","text":""},{"location":"systems/#lightning-experience","title":"Lightning Experience","text":"<p>The Lightning Experience is the visual interface you use after logging in. It allows you to: - Navigate between objects - View, edit, and create records - Access dashboards, reports, and flows  </p> <p>This is where staff spend most of their time.</p>"},{"location":"systems/#reports","title":"Reports","text":"<p>Reports collect and filter data to show specific information. For example: to find flagged mentoring messages, create a report where <code>Filter_Status__c = \"Flagged\"</code> and the message belongs to your cases.  </p> <p>Reports can also use related data from multiple objects, such as:</p> <p>Messages where <code>Filter_Status__c = \"Flagged\"</code> and the related Case is <code>eMentors</code> and the Contact\u2019s <code>FirstName = \"Pippin\"</code>.</p>"},{"location":"systems/#experience-sites","title":"Experience Sites","text":"<p>Experience Sites (formerly \u201cCommunities\u201d) are public-facing web portals that connect directly to Salesforce data. They always include <code>/s/</code> in the URL (example: <code>https://mentoring.bestprep.org/s/student-portal</code>).  </p> <p>These allow non-staff users to: - Submit or view mentoring messages - Register for events - Access dashboards or forms  </p> <p>The Mentor and Student Portals are both Experience Sites.</p>"},{"location":"systems/#flows","title":"Flows","text":"<p>Flows are Salesforce\u2019s no-code automation tools. They can: - Run automatically when records change (Record-Triggered Flows) - Execute on schedules (Scheduled Flows) - Display forms for user interaction (Screen Flows)</p> <p>Flows help automate repetitive tasks such as sending emails, updating fields, or cleaning up records.</p>"},{"location":"systems/#programming-languages-in-salesforce-projects","title":"Programming Languages in Salesforce Projects","text":"<p>Salesforce development often combines Apex, HTML, CSS, JavaScript, and SOQL. Each language serves a distinct purpose in building portals, automations, and data logic.</p>"},{"location":"systems/#apex","title":"Apex","text":"<p>Apex is Salesforce\u2019s backend programming language, similar to Java. It runs entirely on Salesforce servers.</p> <p>It is: - Strongly typed - Object-oriented - Executed in the cloud  </p> <p>Apex is used to: - Run logic before or after record changes (triggers) - Enforce rules and automate complex workflows - Integrate Salesforce with external systems - Support Lightning Web Components (LWCs) through backend data access  </p> <p>When to use Apex: When Flows or Validation Rules cannot perform complex logic or handle large data volumes.</p> <p>Examples: - Creating related records automatically - Updating records in multiple related objects - Running batch jobs or scheduled processes - Supplying data to Lightning Web Components  </p> <p>In our mentoring portals, Apex is primarily used to provide data and handle file submissions for LWCs.</p>"},{"location":"systems/#html","title":"HTML","text":"<p>HTML (HyperText Markup Language) defines the structure of a webpage. In Experience Sites or Lightning Web Components, HTML determines what appears on screen.</p> <p>Example uses: - Displaying text, buttons, and forms - Embedding data retrieved from Apex - Structuring mentor and student message areas  </p> <p>HTML forms the skeleton; everything else builds around it.</p>"},{"location":"systems/#css","title":"CSS","text":"<p>CSS (Cascading Style Sheets) controls how a webpage looks. It manages color, size, spacing, and layout.</p> <p>Example uses: - Styling buttons, cards, or tables in portals - Making pages mobile-friendly - Adding hover effects and animations  </p> <p>CSS ensures the portals match BestPrep\u2019s visual identity while staying accessible and simple.</p>"},{"location":"systems/#javascript","title":"JavaScript","text":"<p>JavaScript makes Salesforce sites interactive. It\u2019s used heavily in Lightning Web Components (LWCs).</p> <p>Example uses: - Validating form input before saving - Fetching data from Apex classes - Dynamically updating the page without refreshing - Managing conditional display of mentor/student messages  </p> <p>In short, Apex handles logic and data. JavaScript handles interactivity and responsiveness.</p>"},{"location":"systems/#soql-salesforce-object-query-language","title":"SOQL (Salesforce Object Query Language)","text":"<p>SOQL is similar to SQL but works specifically for Salesforce data. It retrieves records from objects inside your org.</p> <p>Example: <pre><code>SELECT Id, FirstName, LastName, Email \nFROM Contact \nWHERE Email LIKE '%@bestprep.org'\n</code></pre></p>"},{"location":"systems/#common-uses","title":"Common uses:","text":"<ul> <li>Querying records in Apex code</li> <li>Filtering related data for portals</li> <li>Powering reports or admin scripts</li> <li>SOQL is the language Apex uses to communicate with your Salesforce database.</li> </ul>"},{"location":"systems/#summary","title":"Summary","text":"<ul> <li>Salesforce is structured like a multi-sheet spreadsheet where data is stored as objects, fields, and records.</li> <li>Lightning Experience and Experience Sites provide user-friendly ways to view and edit data.</li> <li>Reports and Flows handle data visualization and automation.</li> <li>Apex, HTML, CSS, JavaScript, and SOQL together power the mentoring portals\u2014combining backend logic, data retrieval, visual layout, styling, and interactivity.</li> </ul>"},{"location":"board/access/","title":"Board of Directors Portal - Access Control","text":"<p>Access control for the board of directors portal is done through Salesforce Community Users. </p>"},{"location":"board/content/","title":"Board of Directors Portal - Flows","text":"<p>All content displayed on the board of directors portal is controlled by screen flows, with the exception of 1 lightning web component. </p>"},{"location":"board/overview/","title":"Board of Directors Portal","text":"<p>The board of directors portal is an Experience Cloud site with restricted visibility and information shown via public screen flows.</p>"},{"location":"flows/flows/","title":"List of Flows","text":"Name Trigger Description API Name Mentoring - Student Prompt Scheduler Schedule-Triggered, daily 7:30am For every active connection in an active case where today is a guiding question date, send the student an email prompt reminding them to write their message. Mentoring_Student_Prompt_Scheduler Mentoring - Create Connection Screen Flow From a case, create a new Connection record and BestPrep Program Participation records from two contacts. If the case is a Cloud Coach case, allow the user to select which child case to put the new connection in. Typically ran via a button on an eMentors or Cloud Coach case. Mentoring_Create_Connection"},{"location":"forms/forms/","title":"List of Forms","text":"Name Type Description Locatione SMG Student Survey LWC Gather student survey results for both pre and post session surveys, and connect to case. Requires two URL tags, <code>advisorId</code> and <code>sessionStatus</code> Forms Experience Site SMG Thank You Letter LWC Allow a student to write a thank-you letter to a sponsor of their choosing. Requires one URL tag, <code>advisorId</code> to connect to the case. Forms Experience Site SMG Teacher Survey LWC The end of session teacher survey for Stock Market Game teachers. Requires one URL tag, <code>advisorId</code> to connect to the case. Forms Experience Site"},{"location":"mentoring/mentoring/","title":"Welcome to the BestPrep Mentoring Portals Documentation","text":"<p>This site documents the custom-built Mentor and Student portals that support BestPrep\u2019s eMentors and Cloud Coach programs. Both portals are powered by a shared Salesforce backend and Lightning Web Components (LWC), with custom Apex, JavaScript, and Flow logic.</p> <p>Use this site to understand the technical design, program logic, and how these tools work together to deliver a seamless mentoring experience.</p>"},{"location":"mentoring/mentoring/#development-edition","title":"Development Edition:","text":"<p>Please note that each portal contains two versions - a production version, and a development version. The development versions simply have \"Dev\" appended to the end of the file name (studentPortalDev.js) and are used to develop and test new features without inturrupting the user experience within the production version. The development versions are not hosted within the documentation site. </p> <p>If you make changes, please always ensure you are testing thoroughly within the development files before deploying to production. The development URLs may be found below: </p> <ul> <li>Mentor Portal (Development)</li> <li>Student Portal (Development)</li> <li>Overview Portal (Development)</li> </ul>"},{"location":"mentoring/mentoring/#system-overview","title":"System Overview","text":""},{"location":"mentoring/mentoring/#specific-to-ementors","title":"Specific to eMentors","text":"<p>The entire system starts differently depending on whether it is an eMentors or a Cloud Coach connection. While Cloud Coach cases are setup by the Cloud Coach Program Manager based on interested schools and available companies, eMentors start with the teacher requesting an eMentors Experience. This is done using a public screen flow hosted on the mentoring experience site. The respective requests are then added to either the teacher or company \"bucket case\" which stores them for the program manager to sort through, pair, and assign as a BestPrep Program Participation record. You can view those here - anytime a teacher or company coordinator requests an eMentors experience, the program manager is notified: </p> <ul> <li>Teacher Sign-Up Flow</li> <li>Teacher Sign-Up Site</li> <li>Teacher Bucket</li> <li>Company Sign-Up Flow</li> <li>Company Sign-Up Site</li> <li>Company Bucket</li> </ul> <p>Once the teacher or company coordinator has recieved their connection conformation, they are also given the opportunity to edit it, through the request edit page. The program manager for eMentors is notified by email anytime a teacher or coordinator makes an update to their request. Once the teacher or company coordinator BPPP has been moved to its respective case, it is no longer available to be edited. </p> <p>The eMentors program manager will use a flow (Move to Case Flow) to create a new case and move both the teacher and company coordinator into it. Along with this process, the program manager will assign a staff to handle the connection, and upon saving, the company coordinator, teacher, and BestPrep staff will all be sent a notification email. </p>"},{"location":"mentoring/mentoring/#portal-upload","title":"Portal Upload","text":"<p>Before this point, the case must be complete - that is, filled out with guiding questions, messaging dates, and Meet &amp; Greet information (if known). Note that for Cloud Coach cases, this information only needs to be entered on the Parent Case, and this flow will copy it to child cases. </p> <p>Beyond this point, both eMentors and Cloud Coach connections are handled the same, with some slight differences in flow control. The first step is uploading a spreadsheet as a .CSV file into the system which contains the following information - this can be downloaded in an easy template for eMentors and Cloud Coach. There is also another version available to send to teachers via email attachement or as a Google Drive Link: </p> <ul> <li>Case ID</li> <li>Mentor First Name</li> <li>Mentor Last Name</li> <li>Mentor Job Title</li> <li>Mentor Email Address</li> <li>Student First Name</li> <li>Student Last Name</li> <li>Student Preferred Name (Optional)</li> <li>Student Pronouns (optional)</li> <li>Student Email Address</li> <li>Connection Type (eMentors or Cloud Coach)</li> </ul> <p>To read more about the portal upload system, go to this page. </p>"},{"location":"mentoring/mentoring/#portal-overview","title":"Portal Overview","text":"<p>The mentoring system consists of 6 major public-facing portals:</p> Portal Description Teacher Sign-Up Used by the teacher to initially request their class participates in eMentors Company Sign-Up Used by the company coordinator to initially request that their company participates in eMentors (or is forwarded onto Cloud Coach if large enough) Request Edit Page Used by teachers to edit their eMentors request as it gets closer to the starting date Mentor Portal Used by mentors to send weekly messages, view student responses, and manage availability Student Portal Used by students to read guiding questions, mentor responses, and submit messages Overview Portal Used by teachers to view weekly connection progress across all students, and by company coordinators to pull statistics from their connection <p>Each portal dynamically loads based on a secure URL with a passkey and connection ID. All data is sourced from custom Salesforce objects and records. The format for the URL follows this formula: </p> <ul> <li> <p>Overview Portal: https://mentoring.bestprep.org/s/connection-overview?caseId={Case.Id}&amp;PW={Case.Case_Password__c}&amp;Role=Teacher</p> </li> <li> <p>Mentor Portal: https://mentoring.bestprep.org/s/mentor-portal?connectionId={Connection.Id}&amp;passkey={Connection.Passkey__c}</p> </li> <li> <p>Student Portal: https://mentoring.bestprep.org/s/student-portal?connectionId={Connection.Id}&amp;passkey={Connection.Passkey__c}</p> </li> </ul>"},{"location":"mentoring/mentoring/#explore-the-code-and-design","title":"Explore the Code and Design","text":""},{"location":"mentoring/mentoring/#mentor-portal","title":"Mentor Portal","text":"<ul> <li>Mentor Portal Overview</li> <li>Mentor Portal Apex</li> <li>Mentor Portal JS &amp; LWC</li> </ul>"},{"location":"mentoring/mentoring/#student-portal","title":"Student Portal","text":"<ul> <li>Student Portal Overview</li> <li>Student Portal Apex</li> <li>Student Portal JS &amp; LWC</li> </ul>"},{"location":"mentoring/mentoring/#overview-portal-teachers-and-company-coordinators","title":"Overview Portal (Teachers and Company Coordinators)","text":"<ul> <li>Overview Portal</li> <li>Overview Portal Apex</li> <li>Overview Portal JS &amp; LWC</li> </ul>"},{"location":"mentoring/mentoring/#ideas-for-future-development","title":"Ideas for future development","text":"<p>The idea has been floated to allow students to choose a mentor themselves, rather than randomly assigning them. This would work by having mentors and students uploaded but not paired into a connection. Then students could view a list of mentors available to them with first name and last initial, what company they work for, their pronouns, and their job title. </p> <p>The idea for an \"announcement system\" is also planned, allowing BestPrep staff to push messages to either the mentor, student, or both portals for a specified amount of time (or until a specified date). This would be controled from the case on the Salesforce side with a few fields, such as Message (text), Audience (picklist), Expiration (date), and Active (check-box) and display as a modal style announcement upon portal load. </p>"},{"location":"mentoring/reports/","title":"Reports","text":"<p>There are multiple reports available for staff use in the mentoring program. Linked below are some of the more commonly used reports. The most common are the flagged message reports. You can find a Salesforce report folder with all of our mentoring reports by clicking this link.</p>"},{"location":"mentoring/reports/#quick-view-table","title":"Quick View Table","text":"<p>| Report Name | Link to Report | | My Flagged Messages | My Flagged Messages | | All Flagged Messages | All Flagged Messages |</p>"},{"location":"mentoring/reports/#flagged-message-reports","title":"Flagged Message Reports","text":"<p>When a message is submitted, it passes through our filtering system, and then is assigned a flag status based on the flagged terms list, whether or not is has a file attached, or if any contact information is detected. </p>"},{"location":"mentoring/reports/#my-flagged-messages","title":"My Flagged Messages","text":"<p>The \"My Flagged Messages\" report shows you all messages for active eMentors &amp; Cloud Coach cases where you are the case owner. If you are looking for flagged messages for a particular user, you will click the filter icon (it looks like a funnel in the top right hand corner) </p> <p></p>"},{"location":"mentoring/reports/#all-flagged-messages","title":"All Flagged Messages","text":"<p>If just seeing a single users flagged messages is not enough, or you want to check on all flagged messages in the system, you can do so with the report \"All Flagged Messages.\" This contains all messages that are flagged for both Cloud Coach and eMentors in our Salesforce system for all time. This report should be entirely empty in the summer and over holidays when no connections are happening.  </p>"},{"location":"mentoring/email_system/email_templates/","title":"Email Templates","text":"<p>Email templates have been designed using BeeFree.io and are generated as inline HTML code, sent via the Lightning Email Template system.</p> <p>All scheduled eMentors Mentor emails are controlled here, daily at 6:30am: eMentors Mentor Connection Handler</p> <p>All scheduled Cloud Coach Mentor emails are controlled here, daily at 6:30am: Cloud Coach Mentor Connection Handler</p> <p>All scheduled student emails are controlled here, daily at 7:30am: Student Connection Handler</p>"},{"location":"mentoring/email_system/email_templates/#ementors","title":"eMentors","text":"Name Trigger Description Template Link Setup Emails Mentoring - Class Request Record Triggered from Flow When a teacher submits a request for an eMentors experience, this template is sent to confirm their information In-Progress Mentoring - Class Request Edit Record Triggered from Flow When a teacher edits their previous request for an eMentors experience, this template is sent to confirm their changes In-Progress Mentoring - Company Request Record Triggered from Flow When a company coordinator submits a request for an eMentors epxerience, this template is sent to confirm their information In-Progress Mentoring - Company Request Edit Record Triggered from Flow When a company coordinator edits their previous request for an eMentors experience, this template is sent to confirm their changes In-Progress Mentoring - Coordinator Handoff Notification (In-Person) Record Triggered from Flow When a coordinator is moved from the bucket to a case and the case is set to assigned, this email is sent from their BPPP Link to Template Mentoring - Coordinator Handoff Notification (Virtual) Record Triggered from Flow When a coordinator is moved from the bucket to a case and the case is set to assigned, this email is sent from their BPPP Link to Template Mentoring - Teacher Handoff Notification (In-Person) Record Triggered from Flow When a teacher is moved from the bucket to a case and the case is set to assigned, this email is sent from their BPPP Link to Template Mentoring - Teacher Handoff Notification (Virtual) Record Triggered from Flow When a coordinator is moved from the bucket to a case and the case is set to assigned, this email is sent from their BPPP Link to Template Scheduled Mentor Emails Mentor Welcome Email (eMentors) Scheduled (on Assigned Start Date) &amp; User Triggerable for Entire Case or Single Connection Mentor welcome email for mentors participating in eMentors connections Link to Template Mentor Activity Prompt Scheduled on activity weeks for 6:30am from Flow Reminds mentors of any virtual activity that is schedule for this week Link to Template Mentor Reminder to Write Scheduled when mentor hasn't replied to student in more than 72 hours An email used for both mentoring programs reminding a mentor that their message is due Link to Template eMentors Mentor Gapfill Scheduled when student misses 2 consecutive messages &amp; more than 72 hours past most recent assigned date This notification lets a mentor know that their student hasn't had a chance to write yet and gives them an opportunity to write a message instead Link to Template Meet &amp; Greet Reminder Scheduled 2 days prior to Meet &amp; Greet Reminds mentor of upcoming Meet &amp; Greet, and to let their student know if they won't be there Link to Template Mentor Program Conclusion Scheduled for Assigned End Date This email reminds the mentor to take their survey, and informs them that the program has finished. Link to Template Mentor Survey Reminder Scheduled for 3 days after Assigned End Date if survey not completed Reminds mentor to take post-connection survey Link to Template Student Message Notification Triggered by a new student message being set to \"Pass\" Send a notification to the mentor that their student wrote a new message Link to Template Triggered Mentor Emails Mentor Drop Notification (To Mentor) Trigger via swap flow on case Send to mentor to notify them that they have been dropped from the program Link to Template Student Drop Notification (To Mentor) Trigger via swap flow on case Send to a mentor to notify them that their student has been dropped from the program Link to Template Mentor Swap Notification (To Mentor) Trigger via swap flow on case Send to a mentor to notify them that they have a new student from a mentor who dropped Link to Template Mentor Portal Link Triggered from connection via Action Button Send mentor an email with their portal link in it Link to Template Student Emails Student Weekly Prompt Scheduled from Flow weekly at 7:30am Weekly prompt to students reminding them to write to their mentor Link to Template Student Reminder to Write Scheduled from connection handler Reminder for a student to write if they are 3-days overdue Link to Template Mentor Drop Notification Triggered by drop/swap system Let a student know if their mentor has dropped out of the program and they are given a new mentor Link to Template Mentor Out-of-Office Notification Triggered by a new messsage being set to \"Pass\" while mentor is Out-of-Office Inform a student that their mentor is out of office if the student sends them a message during that time Link to Template Mentor Message Notification Triggered by a new mentor message being set to \"Pass\" Inform a student that they have gotten a message from their mentor Link to Template Student Portal Link Triggered from Action Button on Connection Used to send a student the link to their portal if they loose it Link to Template Student Survey Reminder Scheduled from Flow on Assigned End Date if survey isn't completed yet Reminder for a student to complete their survey if they haven't by the assigned end date Link to Template"},{"location":"mentoring/email_system/email_templates/#cloud-coach","title":"Cloud Coach","text":"Name Trigger Description Template Link Setup Emails Company Welcome Email Scheduled (1 week prior to assigned start date) Send welcome email to all company coordinators in a parent case along with their portal access link In-Progress Teacher Welcome Email Scheduled (1 week prior to assigned start date) Send welcome email to all teachers in a parent case along with their portal access link In-Progress Coordinator Portal Link Triggered via Action Button Send chosen company coordinators a reminder of what their portal link is Link to Template Mentor Emails Mentor Welcome Email Scheduled (on Assigned Start Date) &amp; User Triggerable for Entire Case or Single Connection Email welcoming mentor to Cloud Coach Link to Template Mentor Prompt Scheduled for 1 week prior to week assigned date Reminds mentor to write Link to Template Mentor Gapfill Email Sends if student hasn't written for two weeks and mentor hasn't written for one week Sent to mentor when student hasn't replied Link to Template Mentor Reminder to Write Scheduled to send 4 days prior to assigned date if no mentor message for that week exists yet Reminds the mentor to write Link to Template Mentor Survey Sends 3 days after assigned end date Send to mentor to remind them about the survey Link to Template Student Emails Student Pre-Survey In-Progress Student Pre-Survey Reminder In-Progress Student Weekly Prompt In-Progress Student Gapfill In-Progress Student Post-Survey In-Progress"},{"location":"mentoring/email_system/email_templates/#new-connection-system","title":"New Connection System","text":"<p>A new connection can be created from a case at any time. If in a child case or eMentors case, it will create the new connection directly in that case. However, if in a Cloud Coach Parent case, it will prompt the user to choose a child case. The contacts for the connection must have already been created, but once they are created in Salesforce, the user can select them from a search box, and the system will automatically create the BestPrep Program Participation records, the connection, and send out notification emails if the current date is greater than or equal to the first message date but not yet the assigned end date. </p> <p>The user will be prompted to add any teachers and company coordinators as CC'd addresses if it is within program dates. </p> Name Trigger Template Link Mentor Notification Triggered from flow Link to Template Student Notification Triggered from Flow Link to Template"},{"location":"mentoring/email_system/email_templates/#drop-swap-system","title":"Drop &amp; Swap System","text":"<p>The drop and swap system can be found on the case level view of any eMentors case or on the child-case level view of any Cloud Coach case. The tool allows a user to select an existing connection, indicate whether they want to swap the mentor or drop the student, and then allow the tool to send out all the necessary notifications. The Drop and Swap System runs from a screen flow with the api name Mentoring_Swap_Mentor_Student.</p> <p>The drop and swap system will also allow users to choose what company coordinators and teachers they would like to be notified on the applicable notifications. </p> Name Trigger Description Template Link Student Drop Notification to Mentor Triggered from Flow Notify a mentor that their student has been dropped from the program Link to Template Student Drop Notification Triggered from Flow Notify a student that they have been dropped from the program Link to Template Mentor Swap Notification to Student Triggered from Flow Notification to student that they are getting a new mentor Link to Template Dropped Mentor Notification Triggered from Flow Notification to Mentor when they have been dropped from the program Link to Template Mentor Swap Notification Triggered from Flow Notification to new mentor when they are taking over a connection from a dropped mentor Link to Template <p></p> <p></p>"},{"location":"mentoring/email_system/notification_email/","title":"Notification Email","text":"<p>Whenever a mentor or student recieves a new message, they get an email alert. This is done using two parts - a flow and a lightning email template. </p>"},{"location":"mentoring/email_system/notification_email/#mentoring-new-message-notification","title":"Mentoring - New Message Notification","text":"<p>The flow Mentoring - New Message Notification is laid out in the following method.</p>   graph TD   N2[Record Triggered Flow] --&gt; N3[Get Recipient Email]   N3 --&gt; N4[Decide: Mentor or Student]   N4 --&gt;|Mentor Wrote| N5[Send Email to Student]   N4 --&gt;|Student Wrote| N6[Send Email to Mentor]   N5 --&gt; N7[End Flow]   N6 --&gt; N8[End Flow]   N2 --&gt;|Error| N9[If An Error Happens]    class N2 click-step-N2;   class N3 click-step-N3;   class N4 click-step-N4;   class N5 click-step-N5;   class N6 click-step-N6;   class N9 click-step-N9;    classDef clickable stroke:#333,stroke-width:2px;   class N2,N3,N4,N5,N6,N9 clickable;"},{"location":"mentoring/email_system/notification_email/#lightning-email-template","title":"Lightning Email Template","text":"<p>There are two lightning email templates used for new message notifications, both created with the website BeeFree.io and then copy and pasted into the lightning email editor after some minor changes. Both email templates are set up to relate to a Message__c record, meaning we can pull merge fields from the message record. This is done with three sets of curly brackets on each side - {{{Like This}}}</p> <p>You can view all of the Mentoring Email Templates inside this folder. </p> <p>Before being merged, the email templates look plain and broken - however, the merge fields will be filled with data later during the flow. We have three merge fields. They may look confusing or duplicate at first, but it makes sense when broken down: Record.Field. The first part is telling the email template what record to look in (the recipient or the message) and the second part is telling it what field to pull data from. So, Message__c.Message__c is saying look inside the Message record and pull the Message field. Remember, the __c just means that it is a custom object, and not something that Salesforce built into their system by default. </p> <ul> <li>{{{Recipient.Familiar_Name__c}}}</li> <li>{{{Message__c.Mentor_Portal_Link__c}}}</li> <li>{{{Message__c.Message__c}}} </li> </ul> <p>All images in the mentoring email templates must be static direct URL type images that are publicly available to be loaded in most email clients (Outlook, Gmail, Yahoo). This means that you cannot use an image in SharePoint or Google Drive (many of our partners have these domains blocked). Best practices for our organization currently is to upload the image as an asset to WordPress and then use the wordpress image URL in the email template - usually in the format of bestprep.org/wp-content/uploads/YYYY/MM/filename.jpg.</p> <p></p> <ul> <li>Mentoring - New Student Message</li> <li>Mentoring - New Mentor Message</li> </ul> \u00d7 Record Triggered Flow <p>When the record is triggered, it works like this: Whenever the object Message__c is updated TO meet the condition from previously not having met the condition, execute the following flow. The condition in this case is whenever Filter_Status__c is changed from being anything else to \"Pass\" - then execute this flow.This ensures that no one gets a message that was still flagged or being reviewed. Additionally, it only runs AFTER the record has been saved, to avoid any accidental mis-clicks.</p> \u00d7 Get Connection Data <p>Once the record has been triggered, our first action is to get the data of the connection that owns the message which was just passed.We do this by finding the Record ID of the connection that owns the message, and then pulling all the data from the connection that has a matching Record ID.We then sort by most recent and only return the first. This shouldn't ever actually be neccesary but is best practice to include.</p> \u00d7 Mentor or Student <p>We use a simple logic statement to decide if the message was from a mentor or a student.If the message was from a mentor, we continue down the \"Send Email to Student\" path. If the message was from a student, we continue down the \"Send Email to Mentor\" path.This is checked using Role__c of the triggering Message__c record.</p> \u00d7 Send Email to Student <p>In this step, we have already decided that a mentor wrote a message, and we want to alert the student. We fill in a few fields in our action that allows us to do this.We send from an organization wide email address (currently ementors@bestprep.org) which has been configured in settings.We use our email template created for this step (Mentoring - New Mentor Message) and also put in both our related record ID and recipient record. The related record is a Message__c object (setup in the lightning email template) and we use the triggering Message__c record. Our recipient is a little more complicated, as this always must be a contact or a lead record - so we go through the Message__c to the Connection__c, then into the student BestPrep_Program_Participation__c, and finally into the Contact where we get Contact Id. This is the recipient record that we will use.</p> \u00d7 Send Email to Mentor <p>In this step, we have already decided that a student wrote a message, and we want to alert the mentor. We fill in a few fields in our action that allows us to do this.We send from an organization wide email address (currently ementors@bestprep.org) which has been configured in settings.We use our email template created for this step (Mentoring - New Student Message) and also put in both our related record ID and recipient record. The related record is a Message__c object (setup in the lightning email template) and we use the triggering Message__c record. Our recipient is a little more complicated, as this always must be a contact or a lead record - so we go through the Message__c to the Connection__c, then into the mentor BestPrep_Program_Participation__c, and finally into the Contact where we get Contact Id. This is the recipient record that we will use.</p> \u00d7 Uh-oh... there was an error. <p>If for any reason an error should occur, Salesforce will not allow any user to pass a message while the error is happening.</p>"},{"location":"mentoring/flagging_system/flagging_system/","title":"Message Flagging System","text":"<p>The message flagging system is put in place to protect mentors, students, and BestPrep from both safety concerns and potential liability. This system checks for the following: </p> <ul> <li>Flagged Words</li> <li>Links</li> <li>Attachments &amp; Files</li> </ul> <p>If you want to remove or add a term from the checked filter list, you can do so here: Filter Terms (Salesforce)</p>"},{"location":"mentoring/flagging_system/flagging_system/#life-of-a-message","title":"Life of a Message","text":"<p>When a message is submitted to our system in any way (via the portal or manually by a BestPrep staff member) it goes through the following process. </p>  flowchart TD     A[Message created] --&gt; B[Status: Flag - New]     B --&gt; C{Scheduled job runs}     C --&gt; D[Load banned terms and message text]     D --&gt; E{Banned word or link?}     E -- Yes --&gt; F[Set status: Flag - In Progress]     E -- No --&gt; G{Attachment present?}     G -- Yes --&gt; H[Create ContentDistribution link]     H --&gt; F     G -- No --&gt; J[Set status: Pass]     F --&gt; K[Save flag reason]     J --&gt; L[Message approved and visible]     F --&gt; M[Awaiting review]     M --&gt; N{Reviewer decision}     N -- Valid --&gt; J     N -- Inappropriate --&gt; O[Remove or escalate]     J --&gt; P[End]     O --&gt; P[End]"},{"location":"mentoring/flagging_system/flagging_system/#flagging-code","title":"Flagging Code","text":"<p>This Apex job automatically scans new mentoring messages to detect inappropriate content or risky files. Every 15 minutes, Salesforce runs this scheduled job to look for new messages marked \u201cFlag \u2013 New.\u201d It checks three things: 1. Whether the message contains any banned words stored in the custom object <code>Filter_Terms__c</code>. 2. Whether the message includes a hyperlink. 3. Whether a file is attached that needs to be safely shared.  </p> <p>If a problem is found, the job flags the message by updating its status to \u201cFlag \u2013 In Progress\u201d and lists the reason in <code>Flag_Reason__c</code>. If a file is attached, the code automatically creates a secure public link using Salesforce <code>ContentDistribution</code>. Messages without issues are marked as \u201cPass.\u201d This automation allows mentors\u2019 and students\u2019 messages to be screened without manual review while still protecting file privacy and message integrity.</p> <p>The scheduled jobs are a group of four, set to run every 15 minutes. </p> <ul> <li><code>Mentoring Message Filter 00</code></li> <li><code>Mentoring Message Filter 15</code></li> <li><code>Mentoring Message Filter 30</code></li> <li><code>Mentoring Message Filter 45</code></li> </ul>"},{"location":"mentoring/flagging_system/flagging_system/#messagefilterscheduledjobcls","title":"MessageFilterScheduledJob.cls","text":"<pre><code>global class MessageFilterScheduledJob implements Schedulable {\n\n    global void execute(SchedulableContext context) {\n        // Load all banned terms\n        Set&lt;String&gt; bannedWords = new Set&lt;String&gt;();\n        for (Filter_Terms__c term : [SELECT Name FROM Filter_Terms__c]) {\n            bannedWords.add(term.Name.toLowerCase());\n        }\n\n        // Load messages to process\n        List&lt;Message__c&gt; messages = [\n            SELECT Id, Message__c, Filter_Status__c, Link_to_File_Attached__c,\n                   (SELECT ContentDocumentId FROM ContentDocumentLinks LIMIT 1)\n            FROM Message__c\n            WHERE Filter_Status__c = 'Flag - New'\n            LIMIT 100\n        ];\n\n        List&lt;Message__c&gt; messagesToUpdate = new List&lt;Message__c&gt;();\n\n        for (Message__c msg : messages) {\n            System.debug('Processing Message: ' + msg.Id);\n\n            String original = msg.Message__c != null ? msg.Message__c.toLowerCase() : '';\n\n\n            Boolean hasBannedWord = false;\n            Boolean hasLink = Pattern.matches('(?i).*(https?://|www\\\\.).*', original);\n\n            Set&lt;String&gt; matchedWords = new Set&lt;String&gt;();\n\n            for (String word : bannedWords) {\n                if (original.contains(word)) {\n                    hasBannedWord = true;\n                    matchedWords.add(word);\n                }\n            }\n\n            Boolean hasAttachment = msg.Link_to_File_Attached__c == 'Attachment Processing';\n\n            List&lt;String&gt; reasons = new List&lt;String&gt;();\n            if (hasAttachment) reasons.add('File Attached');\n            if (!matchedWords.isEmpty()) reasons.addAll(matchedWords);\n\n            // Join and truncate to 255 characters max for the reason field\n            String flagReason = String.join(reasons, ', ');\n            if (flagReason.length() &gt; 255) {\n                flagReason = flagReason.substring(0, 255);\n            }\n            msg.Flag_Reason__c = flagReason;\n\n            // --- FILE HANDLING ---\n            if (hasAttachment) {\n                if (!msg.ContentDocumentLinks.isEmpty()) {\n                    try {\n                        Id contentDocId = msg.ContentDocumentLinks[0].ContentDocumentId;\n                        ContentVersion cv = [\n                    SELECT Id\n                    FROM ContentVersion\n                    WHERE ContentDocumentId = :contentDocId\n                    ORDER BY VersionNumber DESC\n                    LIMIT 1\n                ];\n\n                        ContentDistribution cd = new ContentDistribution();\n                        cd.Name = 'Mentoring Program Attachment';\n                        cd.ContentVersionId = cv.Id;\n                        cd.PreferencesAllowOriginalDownload = false;\n                        cd.PreferencesAllowPDFDownload = true;\n                        cd.PreferencesAllowViewInBrowser = true;\n                        cd.PreferencesLinkLatestVersion = true;\n                        cd.PreferencesNotifyOnVisit = false;\n                        cd.PreferencesPasswordRequired = false;\n\n                        insert cd;\n\n                        cd = [SELECT DistributionPublicUrl FROM ContentDistribution WHERE Id = :cd.Id];\n                        msg.Link_to_File_Attached__c = cd.DistributionPublicUrl;\n                        msg.Filter_Status__c = 'Flag - In Progress';\n\n                    } catch (Exception e) {\n                        System.debug('ContentDistribution creation failed: ' + e.getMessage());\n                        msg.Filter_Status__c = 'Flag - In Progress';\n                    }\n                } else {\n                    System.debug('No ContentDocumentLink found for message: ' + msg.Id);\n                    msg.Filter_Status__c = 'Flag - In Progress';\n                }\n            } else {\n                if (hasBannedWord || hasLink) {\n                    msg.Filter_Status__c = 'Flag - In Progress';\n                } else {\n                    msg.Filter_Status__c = 'Pass';\n                }\n            }\n\n            messagesToUpdate.add(msg);\n        }\n\n\n\n\n\n        if (!messagesToUpdate.isEmpty()) {\n            update messagesToUpdate;\n        }\n    }\n}\n</code></pre>"},{"location":"mentoring/flagging_system/making_updates/","title":"Making Updates","text":"<p>If you need to update the flagging system, there are things can be easily changed by anyone, and parts that need an admin's help. </p> <p>Anyone can:</p> <ul> <li>Add new flagged terms</li> <li>Remove old flagged terms</li> </ul> <p>Only an admin can:</p> <ul> <li>Change frequency of flagging checks</li> <li>Change how messages are checked for flagged terms</li> </ul>"},{"location":"mentoring/mentor_portal/mentor_apex/","title":"Mentoring Sites - Apex Code","text":"<p>The Apex code file provides data from Salesforce to our JavaScript components. MentoringMentorPortal.cls is the main controller. It interacts with Salesforce records to read and update mentor, student, and case information. It also references a helper class called FileAttachQueueable.cls that handles file uploads asynchronously.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#natural-language-explanation-of-code","title":"Natural Language Explanation of Code","text":"<p>The Apex file begins with <code>global without sharing class MentoringMentorPortal</code>. This allows the class to be accessed externally (via LWC or Aura) and to bypass sharing rules so that mentors can access their own connections without needing Salesforce user accounts.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#getconnectiondata","title":"getConnectionData","text":"<p>This method accepts: - <code>connectionId</code> - <code>passkey</code></p> <p>It verifies the connection and then retrieves: - Connection data (names, track, mentor details) - Related case fields (company, school, celebration details) - Guiding Questions for each week - Existing mentor and student messages - Company Coordinator emails for the case</p> <p>It builds a large map containing all this information and returns it for use in the web portal.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#buildtp","title":"buildTP","text":"<p>A private helper used to assemble the guiding question (GQ) information for each week. If a GQ is missing, it returns a placeholder message instead of breaking the data structure.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#upsertmentormessage-upsertmessage","title":"upsertMentorMessage / upsertMessage","text":"<p>Allows mentors to create or edit their weekly messages. It checks passkey validity, then either updates the existing message or creates a new one. All new or edited messages are flagged as <code>\"Flag - New\"</code> for staff review.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#upsertmentormessagewithfile","title":"upsertMentorMessageWithFile","text":"<p>Similar to <code>upsertMentorMessage</code> but also handles file attachments: 1. Validates the connection. 2. Creates or updates the message. 3. Uploads the file to Salesforce Files (<code>ContentVersion</code>). 4. Links the file to the message using <code>ContentDocumentLink</code>. 5. Calls <code>FileAttachQueueable</code> to mark the record as <code>\"Attachment Processing\"</code> until complete.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#updateoutofofficeweeks","title":"updateOutOfOfficeWeeks","text":"<p>Lets mentors mark which weeks they are unavailable and update their track. The portal reads this data to display availability.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#submitvolunteeragreement","title":"submitVolunteerAgreement","text":"<p>Submits the mentor\u2019s volunteer agreement form. It sets the pronouns, ethnicity, and agreement date on the mentor\u2019s associated <code>Contact</code> record.</p>"},{"location":"mentoring/mentor_portal/mentor_apex/#mentoringmentorportalcls","title":"MentoringMentorPortal.cls","text":"<pre><code>global without sharing class MentoringMentorPortal {\n\n    @AuraEnabled\n    public static Map&lt;String, Object&gt; getConnectionData(Id connectionId, String passkey) {\n        Connection__c conn = [\n            SELECT Id, Connection_Passkey__c, Connection_Type__c, Mentor_Out_of_Office__c,\n                   Student_Familiar_Name__c, Mentor_Familiar_Name__c, Mentor_Full_Name__c,\n                   Track__c, Mentor_VAF_Date__c, Mentor_Email__c,\n                   Case__r.Id,\n                   Case__r.Owner.Email,\n                   Case__r.ParentId,\n                   Case__r.Assigned_Company__r.Preferred_Recognition__c,\n                   Case__r.Assigned_School__r.Preferred_Recognition__c,\n                   Case__r.Celebration_Date__c,\n                   Case__r.Celebration_Start_Time__c,\n                   Case__r.Celebration_End_Time__c,\n                   Case__r.Meet_And_Greet_Location_Address__c,\n                   Case__r.CC_Date_1__c, Case__r.CC_Date_2__c, Case__r.CC_Date_3__c, Case__r.CC_Date_4__c,\n                   Case__r.CC_Date_5__c, Case__r.CC_Date_6__c, Case__r.CC_Date_7__c, Case__r.CC_Date_8__c,\n                   Case__r.GQ_1__r.Name, Case__r.GQ_1__r.Mentor_Talking_Points__c, Case__r.GQ_1__r.Enable_Attachments__c,\n                   Case__r.GQ_2__r.Name, Case__r.GQ_2__r.Mentor_Talking_Points__c, Case__r.GQ_2__r.Enable_Attachments__c,\n                   Case__r.GQ_3__r.Name, Case__r.GQ_3__r.Mentor_Talking_Points__c, Case__r.GQ_3__r.Enable_Attachments__c,\n                   Case__r.GQ_4__r.Name, Case__r.GQ_4__r.Mentor_Talking_Points__c, Case__r.GQ_4__r.Enable_Attachments__c,\n                   Case__r.GQ_5__r.Name, Case__r.GQ_5__r.Mentor_Talking_Points__c, Case__r.GQ_5__r.Enable_Attachments__c,\n                   Case__r.GQ_6__r.Name, Case__r.GQ_6__r.Mentor_Talking_Points__c, Case__r.GQ_6__r.Enable_Attachments__c,\n                   Case__r.GQ_7__r.Name, Case__r.GQ_7__r.Mentor_Talking_Points__c, Case__r.GQ_7__r.Enable_Attachments__c,\n                   Case__r.Activity_GQ__r.Name, Case__r.Activity_GQ__r.Mentor_Talking_Points__c, Case__r.Activity_GQ__r.Enable_Attachments__c\n            FROM Connection__c\n            WHERE Id = :connectionId\n            LIMIT 1\n        ];\n\n        if (conn.Connection_Passkey__c != passkey) {\n            throw new AuraHandledException('Invalid Passkey');\n        }\n\n        // Determine which Case to use for coordinator query\n        Id coordinatorCaseId = conn.Connection_Type__c == 'Cloud Coach'\n            ? conn.Case__r.ParentId\n            : conn.Case__c;\n\n        // Get all coordinators for that Case\n        List&lt;BestPrep_Program_Participation__c&gt; coordinatorRecords = [\n            SELECT Role__c, Contact__r.Email\n            FROM BestPrep_Program_Participation__c\n            WHERE Case_Number__c = :coordinatorCaseId\n            AND Role__c = 'Company Coordinator'\n        ];\n\n        // Extract just the email addresses\n        List&lt;String&gt; coordinatorEmails = new List&lt;String&gt;();\n        for (BestPrep_Program_Participation__c bppp : coordinatorRecords) {\n            if (bppp.Contact__r.Email != null) {\n                coordinatorEmails.add(bppp.Contact__r.Email);\n            }\n        }\n\n        // Get messages\n        List&lt;Message__c&gt; messages = [\n            SELECT Id, Week__c, Role__c, Message__c, Filter_Status__c, CreatedDate, Link_to_File_Attached__c\n            FROM Message__c\n            WHERE Connection__c = :connectionId\n        ];\n\n        // Prepare talking points\n        Map&lt;String, Object&gt; talkingPoints = new Map&lt;String, Object&gt;{\n            'Week 1' =&gt; buildTP('Week 1', conn.Case__r.CC_Date_1__c, conn.Case__r.GQ_1__r),\n            'Week 2' =&gt; buildTP('Week 2', conn.Case__r.CC_Date_2__c, conn.Case__r.GQ_2__r),\n            'Week 3' =&gt; buildTP('Week 3', conn.Case__r.CC_Date_3__c, conn.Case__r.GQ_3__r),\n            'Week 4' =&gt; buildTP('Week 4', conn.Case__r.CC_Date_4__c, conn.Case__r.GQ_4__r),\n            'Week 5' =&gt; buildTP('Week 5', conn.Case__r.CC_Date_5__c, conn.Case__r.GQ_5__r),\n            'Week 6' =&gt; buildTP('Week 6', conn.Case__r.CC_Date_6__c, conn.Case__r.GQ_6__r),\n            'Week 7' =&gt; buildTP('Week 7', conn.Case__r.CC_Date_7__c, conn.Case__r.GQ_7__r),\n            'Week 8' =&gt; buildTP('Week 8', conn.Case__r.CC_Date_8__c, conn.Case__r.Activity_GQ__r)\n        };\n\n        return new Map&lt;String, Object&gt;{\n            'connection' =&gt; conn,\n            'messages' =&gt; messages,\n            'talkingPoints' =&gt; talkingPoints,\n            'companyCoordinators' =&gt; coordinatorEmails\n        };\n    }\n\n    private static Map&lt;String, Object&gt; buildTP(String week, Date d, eMentors_GQ__c gq) {\n        if (gq == null) {\n            return new Map&lt;String, Object&gt;{\n                'week' =&gt; week,\n                'dueDate' =&gt; '',\n                'title' =&gt; 'No topic for this week.',\n                'talkingPoints' =&gt; ''\n            };\n        }\n\n        return new Map&lt;String, Object&gt;{\n            'week' =&gt; week,\n            'dueDate' =&gt; d != null ? d.format() : '',\n            'title' =&gt; gq.Name,\n            'talkingPoints' =&gt; gq.Mentor_Talking_Points__c,\n            'enableAttachments' =&gt; gq.Enable_Attachments__c\n        };\n    }\n\n\n\n    @AuraEnabled\n    public static void upsertMentorMessage(Id connectionId, String week, String messageBody, String passkey) {\n        upsertMessage(connectionId, week, 'Mentor', messageBody, passkey);\n    }\n\n    private static void upsertMessage(Id connectionId, String week, String role, String messageBody, String passkey) {\n        Connection__c conn = [\n            SELECT Id, Connection_Passkey__c\n            FROM Connection__c\n            WHERE Id = :connectionId\n        ];\n\n        if (conn.Connection_Passkey__c != passkey) {\n            throw new AuraHandledException('Invalid credentials');\n        }\n\n        Message__c msg;\n        List&lt;Message__c&gt; existing = [\n            SELECT Id\n            FROM Message__c\n            WHERE Connection__c = :connectionId AND Week__c = :week AND Role__c = :role\n        ];\n        if (!existing.isEmpty()) {\n            msg = existing[0];\n            msg.Message__c = messageBody;\n            msg.Filter_Status__c = 'Flag - New';\n            update msg;\n        } else {\n            msg = new Message__c(\n                Connection__c = connectionId,\n            Week__c = week,\n            Role__c = role,\n            Message__c = messageBody,\n            Filter_Status__c = 'Flag - New',\n            OwnerId = UserInfo.getUserId()\n                );\n            insert msg;\n        }\n    }\n\n    @AuraEnabled\n    public static void upsertMentorMessageWithFile(\n        Id connectionId,\n    String week,\n    String messageBody,\n    String passkey,\n    String fileName,\n    String base64FileContent\n    ) {\n        // Validate connection credentials\n        Connection__c conn = [\n        SELECT Id, Connection_Passkey__c\n        FROM Connection__c\n        WHERE Id = :connectionId\n    ];\n\n        if (conn.Connection_Passkey__c != passkey) {\n            throw new AuraHandledException('Invalid credentials');\n        }\n\n        // Upsert the mentor's message\n        Message__c msg;\n        List&lt;Message__c&gt; existing = [\n        SELECT Id\n        FROM Message__c\n        WHERE Connection__c = :connectionId AND Week__c = :week AND Role__c = 'Mentor'\n    ];\n        if (!existing.isEmpty()) {\n            msg = existing[0];\n            msg.Message__c = messageBody;\n            msg.Filter_Status__c = 'Flag - New';\n            update msg;\n        } else {\n            msg = new Message__c(\n                Connection__c = connectionId,\n            Week__c = week,\n            Role__c = 'Mentor',\n            Message__c = messageBody,\n            Filter_Status__c = 'Flag - New'\n                //,OwnerId = UserInfo.getUserId()\n            );\n            insert msg;\n        }\n\n        // Upload and link file (if provided)\n        if (!String.isBlank(fileName) &amp;&amp; !String.isBlank(base64FileContent)) {\n            ContentVersion cv = new ContentVersion(\n                Title = fileName,\n            PathOnClient = fileName,\n            VersionData = EncodingUtil.base64Decode(base64FileContent)\n                );\n            insert cv;\n\n            ContentVersion inserted = [\n            SELECT Id, ContentDocumentId\n            FROM ContentVersion\n            WHERE Id = :cv.Id\n        ];\n\n            insert new ContentDocumentLink(\n                ContentDocumentId = inserted.ContentDocumentId,\n            LinkedEntityId = msg.Id,\n            ShareType = 'V',\n            Visibility = 'AllUsers'\n                );\n\n            System.enqueueJob(new FileAttachQueueable(msg.Id));\n        }\n\n    }\n\n    @AuraEnabled\n    public static void updateOutOfOfficeWeeks(Id connectionId, String passkey, String weeks, String track) {\n        Connection__c conn = [\n        SELECT Id, Connection_Passkey__c\n        FROM Connection__c\n        WHERE Id = :connectionId\n    ];\n\n        if (conn.Connection_Passkey__c != passkey) {\n            throw new AuraHandledException('Invalid credentials');\n        }\n\n        conn.Mentor_Out_of_Office__c = weeks;\n        conn.Track__c = track;\n        update conn;\n    }\n\n\n\n    @AuraEnabled\n    public static void submitVolunteerAgreement(Id connectionId, String passkey, String pronouns, String ethnicity) {\n        Connection__c conn = [\n            SELECT Id, Connection_Passkey__c, Mentor_BPPP__r.Contact__c\n            FROM Connection__c\n            WHERE Id = :connectionId\n        ];\n\n        if (conn.Connection_Passkey__c != passkey) {\n            throw new AuraHandledException('Invalid credentials');\n        }\n\n        Id contactId = conn.Mentor_BPPP__r.Contact__c;\n        if (contactId == null) {\n            throw new AuraHandledException('Mentor contact not found.');\n        }\n\n        Contact c = [SELECT Id FROM Contact WHERE Id = :contactId];\n        c.Pronouns__c = pronouns;\n        c.Ethnicity__c = ethnicity;\n        c.Volunteer_Agreement_Date__c = Date.today();\n        update c;\n    }\n}\n</code></pre>"},{"location":"mentoring/mentor_portal/mentor_apex/#fileattachqueueablecls","title":"FileAttachQueueable.cls","text":"<p>FileAttachQueueable.cls is a secondary helper that only helps with message and file submission.</p> <pre><code>public class FileAttachQueueable implements Queueable {\n\n    private Id msgId;\n\n    public FileAttachQueueable(Id msgId) {\n        this.msgId = msgId;\n    }\n\n    public void execute(QueueableContext context) {\n        try {\n            Message__c msg = [SELECT Id FROM Message__c WHERE Id = :msgId LIMIT 1];\n            msg.Link_to_File_Attached__c = 'Attachment Processing';\n            update msg;\n        } catch (Exception e) {\n            System.debug('FileAttachQueueable failed: ' + e.getMessage());\n        }\n    }\n}\n</code></pre>"},{"location":"mentoring/mentor_portal/mentor_apex/#metadata","title":"Metadata","text":"<p>Each file needs its own separate metadata file as well. However, they are identical other than the naming. Please note that the api version should be regularly reviewed and updated to ensure the system is not depreciated. </p> <p>MentoringMentorPortal.cls-meta.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ApexClass xmlns=\"http://soap.sforce.com/2006/04/metadata\"&gt;\n    &lt;apiVersion&gt;63.0&lt;/apiVersion&gt;\n    &lt;status&gt;Active&lt;/status&gt;\n&lt;/ApexClass&gt;\n</code></pre> <p>FileAttachQueueable.cls-meta.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ApexClass xmlns=\"http://soap.sforce.com/2006/04/metadata\"&gt;\n    &lt;apiVersion&gt;63.0&lt;/apiVersion&gt;\n    &lt;status&gt;Active&lt;/status&gt;\n&lt;/ApexClass&gt;\n</code></pre>"},{"location":"mentoring/mentor_portal/mentor_js/","title":"Mentoring Sites - JavaScript","text":"<p>The JavaScript (called js) is what allows the part of the website we see (the html) to talk to the data we got from Salesforce (the apex code). Below is the code for the mentor portal:</p>"},{"location":"mentoring/mentor_portal/mentor_js/#natural-language-explination-of-code","title":"Natural Language Explination of Code","text":"<p>WIP</p>"},{"location":"mentoring/mentor_portal/mentor_js/#mentorportaljs","title":"mentorPortal.js","text":"<pre><code>import { LightningElement, track, wire } from 'lwc';\nimport { CurrentPageReference } from 'lightning/navigation';\nimport MentoringEasterEgg from '@salesforce/resourceUrl/MentoringEasterEgg';\nimport getConnectionData from '@salesforce/apex/MentoringMentorPortal.getConnectionData';\nimport upsertMentorMessageWithFile from '@salesforce/apex/MentoringMentorPortal.upsertMentorMessageWithFile';\nimport submitVolunteerAgreement from '@salesforce/apex/MentoringMentorPortal.submitVolunteerAgreement';\nimport updateOutOfOfficeWeeks from '@salesforce/apex/MentoringMentorPortal.updateOutOfOfficeWeeks';\n\n\n\nexport default class StudentPortal extends LightningElement {\n  @track isEasterEggVisible = false;\n  @track svgUrl;\n  @track isLoading = true;\n  @track accessDenied = true;\n  @track connectionId;\n  @track pw;\n  @track mentorName = '';\n  @track mentorEmail = '';\n  @track companyName = '';\n  @track weekList = [];\n  @track currentOutOfOffice = [];\n  @track isSettingsOpen = false;\n  @track connectionData = {};\n  @track talkingPoints = {};\n  @track allMessages = [];\n  @track selectedTrack = 'Track 2';\n  @track trackDescription = 'Track 2 is the default track - it will work well for most students.';\n  @track selectedWeek = 'VAF';\n  @track messageBody = '';\n  @track statusMsg = '';\n  @track isInfoOpen = false;\n  @track infoData = {};\n  @track mapMarkers = [];\n  @track mentorResourcesUrl = '';\n  @track trainingVideoUrl = '';\n  @track googleCalUrl = '';\n  @track outlookCalUrl = '';\n  @track bestPrepMailto = '';\n  @track companyCoordMailto = '';\n  @track modalStatusMsg = '';\n  @track vafForm = {\n    pronouns: [],\n    ethnicity: '',\n    agreements: {},\n  };\n  @track vafDateValid = null;\n  @track selectedFile;\n  @track attachmentEnabled = false;\n\n  weekOptions = [\n    { label: 'VAF', value: 'VAF' },\n    { label: 'Week 1', value: 'Week 1' },\n    { label: 'Week 2', value: 'Week 2' },\n    { label: 'Week 3', value: 'Week 3' },\n    { label: 'Week 4', value: 'Week 4' },\n    { label: 'Week 5', value: 'Week 5' },\n    { label: 'Week 6', value: 'Week 6' },\n    { label: 'Week 7', value: 'Week 7' },\n    { label: 'Week 8', value: 'Week 8' },\n    { label: 'Survey', value: 'Survey' }\n  ];\n\n  @wire(CurrentPageReference)\n  async getStateParams(pageRef) {\n    const today = new Date();\n    if (!pageRef?.state?.connectionId || !pageRef?.state?.passkey) return;\n    this.connectionId = pageRef.state.connectionId;\n    this.pw = pageRef.state.passkey;\n\n    try {\n      const result = await getConnectionData({\n        connectionId: this.connectionId,\n        passkey: this.pw\n      });\n\n      this.connectionData = result.connection;\n      this.talkingPoints = result.talkingPoints || {};\n      this.allMessages = result.messages;\n      this.isLoading = false;\n      this.accessDenied = false;\n\n      const fiscalYearStart = today.getMonth() &gt;= 8 ? new Date(today.getFullYear(), 8, 1) : new Date(today.getFullYear() - 1, 8, 1);\n      const fiscalYearEnd = new Date(fiscalYearStart.getFullYear() + 1, 7, 31);\n      const rawVafDate = this.connectionData?.Mentor_VAF_Date__c;\n      const vafDate = rawVafDate ? new Date(rawVafDate) : null;\n      this.vafDateValid = !!(vafDate &amp;&amp; vafDate &gt;= fiscalYearStart &amp;&amp; vafDate &lt;= fiscalYearEnd);\n      this.selectedWeek = this.vafDateValid ? 'Week 1' : 'VAF';\n\n      this.weekOptions = [{\n        label: 'VAF',\n        value: 'VAF',\n        cssClass: this.vafDateValid ? 'sidebar-item disabled' : 'sidebar-item'\n      }];\n\n      if (this.vafDateValid) {\n        for (let i = 1; i &lt;= 8; i++) {\n          const key = `Week ${i}`;\n          const tp = this.talkingPoints[key];\n          if (tp &amp;&amp; tp.talkingPoints) {\n            const isOverdue = this.isWeekOverdue(key);\n            this.weekOptions.push({\n              label: key,\n              value: key,\n              cssClass: 'sidebar-item',\n              isOverdue\n            });\n          }\n        }\n      }\n\n      this.attachmentEnabled = this.talkingPoints[this.selectedWeek]?.enableAttachments || false;\n\n      this.weekOptions.push({\n        label: 'Survey',\n        value: 'Survey',\n        cssClass: 'sidebar-item'\n      });\n\n    } catch (e) {\n      console.error('Connection error:', e);\n      this.isLoading = false;\n      this.accessDenied = true;\n    }\n  }\n\n  connectedCallback() {\n\n    this.svgUrl = MentoringEasterEgg;\n\n    const params = new URLSearchParams(window.location.search);\n    if (params.get('easteregg') === 'true') {\n      this.isEasterEggVisible = true;\n\n      setTimeout(() =&gt; {\n        this.isEasterEggVisible = false;\n      }, 30000);\n    }\n\n\n  }\n\n  renderedCallback() {\n    if (this.accessDenied || !this.connectionData?.Id || typeof this.vafDateValid !== 'boolean') return;\n    const msgBox = this.template.querySelector('[data-id=\"mentorMsg\"]');\n    if (msgBox &amp;&amp; this.mentorMessage) msgBox.innerHTML = this.mentorMessage;\n\n    this.template.querySelectorAll('.sidebar-item').forEach(el =&gt; {\n      const weekVal = el.dataset.week;\n      el.classList.toggle('active-week', weekVal === this.selectedWeek);\n    });\n  }\n\n  handleWeekClick(event) {\n    const el = event.currentTarget;\n    if (el.classList.contains('disabled')) return;\n\n    const selected = el.dataset.week;\n    this.selectedWeek = selected;\n    this.statusMsg = '';\n    this.messageBody = '';\n    this.selectedFile = null;\n    this.attachmentEnabled = this.talkingPoints[selected]?.enableAttachments || false;\n\n    setTimeout(() =&gt; {\n      const msgBox = this.template.querySelector('[data-id=\"mentorMsg\"]');\n      if (msgBox &amp;&amp; this.mentorMessage) msgBox.innerHTML = this.mentorMessage;\n    }, 10);\n  }\n\n  handleChange(event) {\n    this.messageBody = event.target.value;\n  }\n\n  handleFileChange(event) {\n    this.selectedFile = event.target.files[0];\n  }\n\n  openInfoModal() {\n    this.isInfoOpen = true;\n    this.modalStatusMsg = '';\n    this.loadInfoModal();\n  }\n\n  closeInfoModal() {\n    this.isInfoOpen = false;\n  }\n\n\n  openSettingsModal() {\n    this.isSettingsOpen = true;\n  }\n\n  closeSettingsModal() {\n    this.isSettingsOpen = false;\n  }\n\n  handleBackdropClick(event) {\n    this.closeSettingsModal();\n    this.closeInfoModal();\n  }\n\n  stopModalClick(event) {\n    event.stopPropagation();\n  }\n\n  openSettingsModal() {\n    this.isSettingsOpen = true;\n    this.modalStatusMsg = '';\n\n    // Always load current settings (even if weekList is already populated)\n    this.loadMentorSettings();\n  }\n\n  loadInfoModal() {\n    try {\n      const conn = this.connectionData;\n      const caseData = conn.Case__r || {};\n      const type = conn.Connection_Type__c || '';\n      const event = type === 'Cloud Coach' ? 'Cloud Summit' : 'Meet &amp; Greet';\n\n      this.mentorResourcesUrl = type === 'Cloud Coach'\n        ? 'https://bestprep.org/cloud-coach-volunteers/resources/'\n        : 'https://bestprep.org/ementors-volunteers/resources/';\n\n      this.trainingVideoUrl = type === 'Cloud Coach'\n        ? 'https://youtu.be/zQT96G5pNYY'\n        : 'https://www.youtube.com/watch?v=_nDPkJ80hvw';\n\n      const date = caseData.Celebration_Date__c; // e.g., \"2025-07-30\"\n      const startTime = caseData.Celebration_Start_Time__c; // e.g., \"11:00 AM\"\n      const endTime = caseData.Celebration_End_Time__c;     // e.g., \"2:00 PM\"\n      const calAddress = caseData.Meet_And_Greet_Location_Address__c || '';\n      const school = caseData.Assigned_School__r?.Preferred_Recognition__c || '';\n      const company = caseData.Assigned_Company__r?.Preferred_Recognition__c || '';\n      const title = `${event} - ${school} &amp; ${company}`;\n\n      // Convert AM/PM to 24-hour\n      const to24Hour = (timeStr) =&gt; {\n        const [time, modifier] = timeStr.split(' ');\n        let [hours, minutes] = time.split(':');\n        hours = parseInt(hours, 10);\n\n        if (modifier === 'PM' &amp;&amp; hours !== 12) hours += 12;\n        if (modifier === 'AM' &amp;&amp; hours === 12) hours = 0;\n\n        return `${hours.toString().padStart(2, '0')}:${minutes}`;\n      };\n\n      const startTime24 = to24Hour(startTime);\n      const endTime24 = to24Hour(endTime);\n\n      const startDateTime = `${date}T${startTime24}:00`;\n      const endDateTime = `${date}T${endTime24}:00`;\n\n\n      // Google Calendar (UTC required)\n      const formatForGoogle = (dateStr) =&gt; {\n        const dt = new Date(dateStr); // assumes local time\n        if (isNaN(dt)) {\n          console.warn('Invalid date for calendar:', dateStr);\n          return '';\n        }\n        return dt.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';\n      };\n\n\n      const googleStart = formatForGoogle(startDateTime);\n      const googleEnd = formatForGoogle(endDateTime);\n\n      if (googleStart &amp;&amp; googleEnd) {\n        const googleParams = new URLSearchParams({\n          action: 'TEMPLATE',\n          text: title,\n          dates: `${googleStart}/${googleEnd}`,\n          location: calAddress,\n          details: 'Event details available in your BestPrep mentor portal.'\n        });\n        this.googleCalUrl = `https://calendar.google.com/calendar/render?${googleParams.toString()}`;\n      } else {\n        this.googleCalUrl = '';\n      }\n\n\n      // Outlook Calendar (local)\n      const outlookParams = new URLSearchParams({\n        path: '/calendar/action/compose',\n        rru: 'addevent',\n        startdt: startDateTime,\n        enddt: endDateTime,\n        subject: title,\n        location: calAddress,\n        body: 'Event details available in your BestPrep mentor portal.'\n      });\n      this.outlookCalUrl = `https://outlook.office.com/calendar/0/deeplink/compose?${outlookParams.toString()}`;\n\n      // Emails\n      const bestPrepEmail = caseData.Owner?.Email || '';\n      this.bestPrepMailto = `mailto:${bestPrepEmail}?subject=Mentor Info&amp;body=Hello BestPrep Coordinator,%0D%0A...`;\n\n      const ccList = this.connectionData?.companyCoordinators || [];\n      if (ccList.length &gt; 0) {\n        const to = ccList[0];\n        const cc = ccList.slice(1).join(',');\n        this.companyCoordMailto = `mailto:${to}?cc=${cc}&amp;subject=Mentor Info&amp;body=Hello Company Coordinator,%0D%0A...`;\n      }\n\n      // Map address split\n      const address = calAddress;\n      let street = '', city = '', state = '', postalCode = '';\n      const parts = address.split(',');\n      if (parts.length === 3) {\n        street = parts[0].trim();\n        city = parts[1].trim();\n        const stateZip = parts[2].trim().split(' ');\n        if (stateZip.length &gt;= 2) {\n          state = stateZip[0];\n          postalCode = stateZip[1];\n        }\n      }\n\n      this.mapMarkers = street &amp;&amp; city &amp;&amp; state &amp;&amp; postalCode ? [{\n        location: { Street: street, City: city, State: state, PostalCode: postalCode },\n        title: event,\n        description: 'Event Location'\n      }] : [];\n\n      this.infoData = {\n        event,\n        date,\n        startTime,\n        endTime,\n        address\n      };\n    } catch (e) {\n      console.error('Error loading info modal:', e);\n    }\n  }\n\n\n  loadMentorSettings() {\n    const conn = this.connectionData;\n\n    this.mentorName = conn.Mentor_Full_Name__c;\n    this.mentorEmail = conn.Mentor_Email__c;\n    this.companyName = conn.Case__r?.Assigned_Company__r?.Preferred_Recognition__c || '';\n    this.modalStatusMsg = '';\n\n\n    this.selectedTrack = conn.Track__c || 'Track 2';\n    this.trackDescription = this.getTrackDescription(this.selectedTrack);\n\n\n    this.selectedTrack = ''; // force LWC to re-track\n    setTimeout(() =&gt; {\n      this.selectedTrack = conn.Track__c || 'Track 2';\n      this.trackDescription = this.getTrackDescription(this.selectedTrack);\n    }, 0);\n\n    const outOfOffice = conn.Mentor_Out_of_Office__c || '';\n    this.currentOutOfOffice = outOfOffice.split(';').map(w =&gt; w.trim());\n\n    this.weekList = [];\n    for (let i = 1; i &lt;= 8; i++) {\n      const tp = this.talkingPoints[`Week ${i}`];\n      if (tp &amp;&amp; tp.dueDate) {\n        this.weekList.push({\n          label: `Week ${i} (${tp.dueDate})`,\n          name: `Week ${i}`,\n          checked: this.currentOutOfOffice.includes(`Week ${i}`)\n        });\n      }\n    }\n\n    const half = Math.ceil(this.weekList.length / 2);\n    this.weekListLeft = this.weekList.slice(0, half);\n    this.weekListRight = this.weekList.slice(half);\n  }\n\n\n\n  handleWeekToggle(event) {\n    const week = event.target.name;\n    const isChecked = event.target.checked;\n\n    // Update currentOutOfOffice\n    if (isChecked) {\n      if (!this.currentOutOfOffice.includes(week)) {\n        this.currentOutOfOffice.push(week);\n      }\n    } else {\n      this.currentOutOfOffice = this.currentOutOfOffice.filter(w =&gt; w !== week);\n    }\n\n    // Sync checked status in weekList\n    this.weekList = this.weekList.map(w =&gt; ({\n      ...w,\n      checked: w.name === week ? isChecked : w.checked\n    }));\n  }\n\n  handleUpdateSettings() {\n    try {\n      const selectedWeeks = this.weekList\n        .filter(w =&gt; w.checked)\n        .map(w =&gt; w.name)\n        .join(';');\n\n      updateOutOfOfficeWeeks({\n        connectionId: this.connectionId,\n        passkey: this.pw,\n        weeks: selectedWeeks,\n        track: this.selectedTrack\n      })\n        .then(() =&gt; {\n          this.connectionData.Mentor_Out_of_Office__c = selectedWeeks;\n          this.connectionData.Track__c = this.selectedTrack;\n\n          this.currentOutOfOffice = selectedWeeks.split(';');\n          this.weekList.forEach(w =&gt; {\n            w.checked = this.currentOutOfOffice.includes(w.name);\n          });\n\n          const half = Math.ceil(this.weekList.length / 2);\n          this.weekListLeft = this.weekList.slice(0, half);\n          this.weekListRight = this.weekList.slice(half);\n\n          this.modalStatusMsg = 'Settings updated successfully.';\n        })\n        .catch((e) =&gt; {\n          console.error('Update error:', e);\n          this.modalStatusMsg = 'An error occurred while saving your settings.';\n        });\n    } catch (e) {\n      console.error('JS error:', e);\n      this.modalStatusMsg = 'Unexpected error while saving your settings.';\n    }\n  }\n\n\n  handleReportError() {\n    const conn = this.connectionData;\n    const coordinatorEmail = conn?.Case__r?.Owner?.Email;\n    const connectionId = conn?.Id;\n    const connectionType = conn?.Connection_Type__c;\n\n    if (!coordinatorEmail || !connectionId || !connectionType) {\n      this.modalStatusMsg = 'Could not find coordinator email or connection info.';\n      return;\n    }\n\n    const connectionUrl = `https://bestprep.lightning.force.com/lightning/r/Connection__c/${connectionId}/view`;\n\n    const subject = encodeURIComponent('Please Update my Information');\n    const body = encodeURIComponent(\n      `Hi!\\n\\nCan you please update my information for the ${connectionType} Connection?\\n\\n${connectionType} Connection: ${connectionUrl}`\n    );\n\n    const mailtoLink = `mailto:${coordinatorEmail}?subject=${subject}&amp;body=${body}`;\n    window.location.href = mailtoLink;\n  }\n\n\n  async handleSubmit() {\n    const cleanHtml = this.sanitizeInput(this.messageBody);\n    const triggerEasterEgg = cleanHtml.toLowerCase().includes('i am underpaid');\n\n    try {\n      let base64FileContent = '';\n      let fileName = '';\n\n      if (this.attachmentEnabled &amp;&amp; this.selectedFile) {\n        if (this.selectedFile.type !== 'application/pdf') {\n          this.statusMsg = 'Only PDF files are allowed.';\n          return;\n        }\n\n        const fileData = await this.readFileAsBase64(this.selectedFile);\n        base64FileContent = fileData;\n        fileName = this.selectedFile.name;\n      }\n\n      await upsertMentorMessageWithFile({\n        connectionId: this.connectionId,\n        week: this.selectedWeek,\n        messageBody: cleanHtml,\n        passkey: this.pw,\n        fileName,\n        base64FileContent\n      });\n\n      if (triggerEasterEgg) {\n        this.isEasterEggVisible = true;\n        setTimeout(() =&gt; {\n          this.isEasterEggVisible = false;\n          window.location.reload();\n        }, 30000); // 30,000 = 30 seconds\n      } else {\n        window.location.reload();\n      }\n\n    } catch (e) {\n      console.error('Submission error:', e);\n      this.statusMsg = e?.body?.message || e?.message || 'An error occurred while submitting.';\n    }\n  }\n\n\n  readFileAsBase64(file) {\n    return new Promise((resolve, reject) =&gt; {\n      const reader = new FileReader();\n      reader.onload = () =&gt; {\n        const base64 = reader.result.split(',')[1];\n        resolve(base64);\n      };\n      reader.onerror = () =&gt; reject(reader.error);\n      reader.readAsDataURL(file);\n    });\n  }\n\n  handleCheckboxChange(event) {\n    const name = event.target.name;\n    if (event.target.type === 'checkbox') {\n      this.vafForm.agreements[name] = event.target.checked;\n    } else {\n      this.vafForm[name] = event.detail.value;\n    }\n  }\n\n  selectSupportTrack() {\n    this.selectedTrack = 'Support Track';\n    this.trackDescription = this.getTrackDescription(this.selectedTrack);\n  }\n\n  selectTrack1() {\n    this.selectedTrack = 'Track 1';\n    this.trackDescription = this.getTrackDescription(this.selectedTrack);\n  }\n\n  selectTrack2() {\n    this.selectedTrack = 'Track 2';\n    this.trackDescription = this.getTrackDescription(this.selectedTrack);\n  }\n\n  selectTrack3() {\n    this.selectedTrack = 'Track 3';\n    this.trackDescription = this.getTrackDescription(this.selectedTrack);\n  }\n\n\n  getTrackDescription(track) {\n    switch (track) {\n      case 'Support Track':\n        return 'Support Track is for students that have not replied to you after two weeks.';\n      case 'Track 1':\n        return 'Track 1 focuses on building a strong foundation with simple questions.';\n      case 'Track 2':\n        return 'Track 2 is the default track - it will work well for most students.';\n      case 'Track 3':\n        return 'Track 3 is for advanced students. Use this track if your student is writing long and engaging messages.';\n      default:\n        return '';\n    }\n  }\n\n\n\n  async handleVafSubmit() {\n    const { pronouns, ethnicity, agreements } = this.vafForm;\n\n    const hasPronoun = Array.isArray(pronouns) &amp;&amp; pronouns.length &gt; 0;\n    const hasEthnicity = ethnicity &amp;&amp; ethnicity.trim() !== '';\n    const allAgreed = ['agreeBelief', 'watchedVideo', 'agreePractice']\n      .every(key =&gt; agreements[key] === true);\n\n    if (!hasPronoun) {\n      this.statusMsg = 'Please select at least one pronoun.';\n      return;\n    }\n\n    if (!hasEthnicity) {\n      this.statusMsg = 'Please select an ethnicity.';\n      return;\n    }\n\n    if (!allAgreed) {\n      this.statusMsg = 'Please check all three agreement boxes.';\n      return;\n    }\n\n    try {\n      await submitVolunteerAgreement({\n        connectionId: this.connectionId,\n        passkey: this.pw,\n        pronouns: pronouns.join('; '),\n        ethnicity: ethnicity\n      });\n      window.location.reload();\n    } catch (e) {\n      console.error('submitVolunteerAgreement error', JSON.stringify(e));\n      this.statusMsg = e?.body?.message || e?.message || 'Error submitting VAF.';\n    }\n  }\n\n\n  sanitizeInput(html) {\n    const div = document.createElement('div');\n    div.innerHTML = html;\n    div.querySelectorAll('img').forEach(img =&gt; img.remove());\n    return div.innerHTML;\n  }\n\n  get isCloudCoach() {\n    return this.connectionData.Connection_Type__c === 'Cloud Coach';\n  }\n\n  get isVAF() {\n    return this.selectedWeek === 'VAF';\n  }\n\n  get isSurveyWeek() {\n    return this.selectedWeek === 'Survey';\n  }\n\n  get mentorMessageNeedsReview() {\n    return this.mentorMessage &amp;&amp; this.mentorMessageStatus !== 'Pass';\n  }\n\n  get mentorFileLink() {\n    const msg = this.allMessages.find(m =&gt; m.Week__c === this.selectedWeek &amp;&amp; m.Role__c === 'Mentor');\n    return msg?.Link_to_File_Attached__c || null;\n  }\n\n  get isMentorFileProcessing() {\n    const msg = this.allMessages.find(m =&gt; m.Week__c === this.selectedWeek &amp;&amp; m.Role__c === 'Mentor');\n    return msg?.Link_to_File_Attached__c === 'Attachment Processing';\n  }\n\n\n  get studentFileLink() {\n    const msg = this.allMessages.find(m =&gt; m.Week__c === this.selectedWeek &amp;&amp; m.Role__c === 'Student');\n    return msg?.Filter_Status__c === 'Pass' ? msg?.Link_to_File_Attached__c : null;\n  }\n\n  get studentFamiliarName() {\n    return this.connectionData?.Student_Familiar_Name__c || '';\n  }\n\n  get mentorFullName() {\n    return this.connectionData?.Mentor_Full_Name__c || '';\n  }\n\n  get assignedCompany() {\n    return this.connectionData?.Case__r.Assigned_Company__r.Preferred_Recognition__c || '';\n  }\n\n  get assignedSchool() {\n    return this.connectionData?.Case__r.Assigned_School__r.Preferred_Recognition__c || '';\n  }\n\n  get studentMessage() {\n    const msg = this.allMessages.find(m =&gt; m.Week__c === this.selectedWeek &amp;&amp; m.Role__c === 'Student');\n    if (!msg) return '';\n    return msg.Filter_Status__c === 'Pass' ? msg.Message__c : `${this.studentFamiliarName}'s message is still pending manual review.`;\n  }\n\n  get mentorMessage() {\n    return this.allMessages.find(m =&gt; m.Week__c === this.selectedWeek &amp;&amp; m.Role__c === 'Mentor')?.Message__c;\n  }\n\n  get mentorMessageStatus() {\n    const msg = this.allMessages.find(m =&gt; m.Week__c === this.selectedWeek &amp;&amp; m.Role__c === 'Mentor');\n    return msg?.Filter_Status__c;\n  }\n\n  get supportTrackVariant() {\n    return this.selectedTrack === 'Support Track' ? 'brand' : 'neutral';\n  }\n  get track1Variant() {\n    return this.selectedTrack === 'Track 1' ? 'brand' : 'neutral';\n  }\n  get track2Variant() {\n    return this.selectedTrack === 'Track 2' ? 'brand' : 'neutral';\n  }\n  get track3Variant() {\n    return this.selectedTrack === 'Track 3' ? 'brand' : 'neutral';\n  }\n\n  // Dynamic event name based on type\n  get eventName() {\n    return this.connectionData?.Connection_Type__c === 'Cloud Coach' ? 'Cloud Summit' : 'Meet &amp; Greet';\n  }\n\n\n  get googleCalendarLabel() {\n    return `Add ${this.eventName} to Google Calendar`;\n  }\n\n  get outlookCalendarLabel() {\n    return `Add ${this.eventName} to Outlook Calendar`;\n  }\n\n  get contactCompanyCoordinatorLabel() {\n    return `Contact ${this.assignedCompany} Coordinator`;\n  }\n\n\n  // Date/time formatting (optional based on data)\n  get eventDate() {\n    return this.connectionData?.Case__r?.Celebration_Date__c || '';\n  }\n\n  get eventStartTime() {\n    return this.connectionData?.Case__r?.Celebration_Start_Time__c || '';\n  }\n  get eventEndTime() {\n    return this.connectionData?.Case__r?.Celebration_End_Time__c || '';\n  }\n  get eventAddress() {\n    return this.connectionData?.Case__r?.Meet_And_Greet_Location_Address__c || '';\n  }\n\n\n\n  get mentorCanWrite() {\n    const tp = this.talkingPoints[this.selectedWeek];\n    if (!tp?.dueDate) return false;\n\n    const today = new Date();\n    const due = new Date(tp.dueDate);\n    const studentWrote = !!this.studentMessage;\n    const mentorWrote = !!this.mentorMessage;\n\n    if (this.isCloudCoach) {\n      const early = new Date(due);\n      early.setDate(early.getDate() - 7);\n      return today &gt;= early;\n    }\n\n    const late = new Date(due);\n    late.setDate(late.getDate() + 14);\n    return !mentorWrote &amp;&amp; (studentWrote || today &gt;= late);\n  }\n\n  get mentorCanWriteDateText() {\n    const tp = this.talkingPoints[this.selectedWeek];\n    if (!tp?.dueDate) return '';\n    const due = new Date(tp.dueDate);\n    const ref = new Date(due);\n    ref.setDate(ref.getDate() + (this.isCloudCoach ? -7 : 14));\n    return ref.toLocaleDateString();\n  }\n\n  get currentGuidingQuestion() {\n    return this.talkingPoints[this.selectedWeek] || { title: '', dueDate: '', talkingPoints: '' };\n  }\n\n  get leftMessageLabel() {\n    return this.isCloudCoach ? 'Your' : `${this.studentFamiliarName}'s`;\n  }\n\n  get rightMessageLabel() {\n    return this.isCloudCoach ? `${this.studentFamiliarName}'s` : 'Your';\n  }\n\n  get leftMessageContent() {\n    return this.isCloudCoach ? this.mentorMessage : this.studentMessage;\n  }\n\n  get pronounOptions() {\n    return [\n      { label: 'She/Her', value: 'She/Her' },\n      { label: 'He/Him', value: 'He/Him' },\n      { label: 'They/Them', value: 'They/Them' },\n      { label: \"Ey/em\", value: \"Ey/em\" },\n      { label: \"Ze/zir\", value: \"Ze/zir\" },\n      { label: \"Co/co\", value: \"Co/co\" },\n      { label: 'Prefer not to say', value: 'Prefer not to say' }\n    ];\n  }\n\n  get ethnicityOptions() {\n    return [\n      { label: 'Asian', value: 'Asian' },\n      { label: 'Black or African American', value: 'Black or African American' },\n      { label: 'Hispanic or Latino', value: 'Hispanic or Latino' },\n      { label: 'White', value: 'White' },\n      { label: \"American Indian\", value: \"American Indian\" },\n      { label: \"Two or more races\", value: \"Two or more races\" },\n      { label: 'Other', value: 'Other' },\n      { label: 'Prefer not to say', value: 'Prefer not to say' }\n    ];\n  }\n\n  get vafCheckboxes() {\n    return [\n      { name: 'agreeBelief', label: 'I have read the Belief Statements.' },\n      { name: 'watchedVideo', label: 'I have watched the cultural humility video.' },\n      { name: 'agreePractice', label: 'I agree to practice cultural humility.' }\n    ];\n  }\n\n  isWeekOverdue(week) {\n    const tp = this.talkingPoints[week];\n    if (!tp?.dueDate) return false;\n\n    const dueDate = new Date(tp.dueDate);\n    const today = new Date();\n\n    const mentorMsg = this.allMessages.find(m =&gt; m.Week__c === week &amp;&amp; m.Role__c === 'Mentor');\n    const studentMsg = this.allMessages.find(m =&gt; m.Week__c === week &amp;&amp; m.Role__c === 'Student');\n\n    if (this.isCloudCoach) {\n      return today &gt; dueDate &amp;&amp; !mentorMsg;\n    } else {\n      if (studentMsg &amp;&amp; !mentorMsg) {\n        const threeDaysAfterStudent = new Date(studentMsg.CreatedDate);\n        threeDaysAfterStudent.setDate(threeDaysAfterStudent.getDate() + 3);\n        return today &gt; threeDaysAfterStudent;\n      }\n      return false;\n    }\n  }\n}\n</code></pre>"},{"location":"mentoring/mentor_portal/mentor_js/#metadata","title":"Metadata","text":"<p>Similarly to our Apex code, the JavaScript also needs a meta file for Salesforce LWC use. </p> <p>mentorPortal.js-meta.xml <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;LightningComponentBundle xmlns=\"http://soap.sforce.com/2006/04/metadata\"&gt;\n  &lt;apiVersion&gt;59.0&lt;/apiVersion&gt;\n  &lt;isExposed&gt;true&lt;/isExposed&gt;\n  &lt;targets&gt;\n    &lt;target&gt;lightningCommunity__Page&lt;/target&gt;\n  &lt;/targets&gt;\n&lt;/LightningComponentBundle&gt;\n</code></pre></p>"},{"location":"mentoring/mentor_portal/mentor_portal/","title":"BestPrep's Mentor Portal","text":"<p>The mentor portal (built by Tovin Sannes-Venhuizen, 2025) has become the new home for all of BestPrep's Mentor Tools. While it packs a lot of functionality, it has a few different components under the hood that allow it to function properly. </p> <ul> <li>Apex Code</li> <li>JavaScript</li> <li>HTML &amp; CSS</li> </ul>"},{"location":"mentoring/mentor_portal/mentor_portal/#screenshots","title":"Screenshots","text":"<p>The portal comes complete with info and settings modals, to help the mentor have the best possible experience. </p>"},{"location":"mentoring/mentor_portal/mentor_portal/#mentor-info-modal","title":"Mentor Info Modal","text":""},{"location":"mentoring/mentor_portal/mentor_portal/#mentor-settings-modal","title":"Mentor Settings Modal","text":""},{"location":"mentoring/mentor_portal/mentor_web/","title":"Mentoring Sites - HTML &amp; CSS","text":""},{"location":"mentoring/mentor_portal/mentor_web/#natural-language-explination-of-code","title":"Natural Language Explination of Code","text":"<p>HTML (what we see), and the CSS (the code that tells our computer how to style the HTML) are below. Think of the HTML like the structure of the house, and the CSS like the paint and wallpaper. </p>"},{"location":"mentoring/mentor_portal/mentor_web/#mentorportalhtml","title":"mentorPortal.html","text":"<pre><code>&lt;template&gt;\n  &lt;!-- Loading Spinner --&gt;\n  &lt;div if:true={isLoading} class=\"spinner-wrapper\"&gt;\n    &lt;lightning-spinner alternative-text=\"Loading\" size=\"large\"&gt;&lt;/lightning-spinner&gt;\n  &lt;/div&gt;\n\n  &lt;!-- Loaded View --&gt;\n  &lt;div if:false={isLoading}&gt;\n    &lt;!-- Access Denied --&gt;\n    &lt;template if:true={accessDenied}&gt;\n      &lt;h1&gt;Access denied. Please check your credentials.&lt;/h1&gt;\n    &lt;/template&gt;\n\n    &lt;!-- Main Portal --&gt;\n    &lt;template if:false={accessDenied}&gt;\n      &lt;div class=\"container\"&gt;\n\n        &lt;!-- Top Button Group --&gt;\n        &lt;div class=\"button-group-top\"&gt;\n          &lt;div class=\"info-button\" onclick={openInfoModal}&gt;\n            &lt;lightning-icon icon-name=\"utility:info\" alternative-text=\"More Information\" size=\"small\"&gt;&lt;/lightning-icon&gt;\n          &lt;/div&gt;\n          &lt;div class=\"settings-button\" onclick={openSettingsModal}&gt;\n            &lt;lightning-icon icon-name=\"utility:settings\" alternative-text=\"Settings\" size=\"small\"&gt;&lt;/lightning-icon&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n\n\n          &lt;template if:true={isEasterEggVisible}&gt;\n            &lt;div class=\"easteregg-backdrop\"&gt;\n              &lt;div class=\"easteregg-wrapper\"&gt;\n                &lt;object data={svgUrl} type=\"image/svg+xml\" class=\"easteregg-svg\"&gt;&lt;/object&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/template&gt;\n\n\n\n        &lt;!-- INFO MODAL --&gt;\n        &lt;template if:true={isInfoOpen}&gt;\n          &lt;section role=\"dialog\" tabindex=\"-1\" class=\"modal-backdrop\" onclick={handleBackdropClick}&gt;\n            &lt;div class=\"settings-modal\" onclick={stopModalClick}&gt;\n              &lt;div class=\"modal-header\"&gt;\n                &lt;lightning-icon icon-name=\"utility:close\" alternative-text=\"Close\" size=\"x-small\"\n                  onclick={closeInfoModal} class=\"close-icon\"&gt;&lt;/lightning-icon&gt;\n              &lt;/div&gt;\n              &lt;div class=\"modal-body\"&gt;\n                &lt;div class=\"info-grid\"&gt;\n                  &lt;div class=\"info-box\"&gt;\n                    &lt;p&gt;&lt;strong&gt;{eventName} Date:&lt;/strong&gt; {eventDate}&lt;/p&gt;\n                    &lt;p&gt;&lt;strong&gt;{eventName} Start Time:&lt;/strong&gt; {eventStartTime}&lt;/p&gt;\n                    &lt;p&gt;&lt;strong&gt;{eventName} End Time:&lt;/strong&gt; {eventEndTime}&lt;/p&gt;\n                  &lt;/div&gt;\n                  &lt;div class=\"info-box\"&gt;\n                    &lt;p&gt;&lt;strong&gt;{eventName} Address:&lt;/strong&gt; {eventAddress}&lt;/p&gt;\n                    &lt;lightning-map map-markers={mapMarkers} zoom-level=\"14\" style=\"height: 200px;\"&gt;&lt;/lightning-map&gt;\n                  &lt;/div&gt;\n                  &lt;div class=\"info-box\"&gt;\n                    &lt;a href={mentorResourcesUrl} target=\"_blank\" class=\"link-button\"&gt;Mentor Resources&lt;/a&gt;&lt;br&gt;\n                    &lt;a href={trainingVideoUrl} target=\"_blank\" class=\"link-button\"&gt;Training Video&lt;/a&gt;\n                  &lt;/div&gt;\n                  &lt;div class=\"info-box\"&gt;\n                    &lt;a href={googleCalUrl} target=\"_blank\" class=\"link-button\"&gt;Add to Google Calendar&lt;/a&gt;&lt;br&gt;\n                    &lt;a href={outlookCalUrl} target=\"_blank\" class=\"link-button\"&gt;Add to Outlook Calendar&lt;/a&gt;\n                  &lt;/div&gt;\n                &lt;/div&gt;\n                &lt;div class=\"modal-footer\"&gt;\n                  &lt;a href={bestPrepMailto} class=\"link-button\"&gt;Contact BestPrep Coordinator&lt;/a&gt;\n                  &lt;a href={companyCoordMailto} class=\"link-button\"&gt;{contactCompanyCoordinatorLabel}&lt;/a&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/section&gt;\n        &lt;/template&gt;\n\n        &lt;!-- SETTINGS MODAL --&gt;\n        &lt;template if:true={isSettingsOpen}&gt;\n          &lt;section role=\"dialog\" tabindex=\"-1\" class=\"modal-backdrop\" onclick={handleBackdropClick}&gt;\n            &lt;div class=\"settings-modal\" onclick={stopModalClick}&gt;\n              &lt;div class=\"modal-header\"&gt;\n                &lt;lightning-icon icon-name=\"utility:close\" alternative-text=\"Close\" size=\"x-small\"\n                  onclick={closeSettingsModal} class=\"close-icon\"&gt;&lt;/lightning-icon&gt;\n              &lt;/div&gt;\n              &lt;div class=\"modal-body\"&gt;\n                &lt;h2 style=\"text-align: center;\"&gt;BestPrep's Mentor Portal Settings&lt;/h2&gt;\n                &lt;div class=\"mentor-info\"&gt;\n                  &lt;p&gt;&lt;strong&gt;Name:&lt;/strong&gt; {mentorFullName}&lt;/p&gt;\n                  &lt;p&gt;&lt;strong&gt;Company:&lt;/strong&gt; {assignedCompany}&lt;/p&gt;\n                  &lt;p&gt;&lt;strong&gt;Email:&lt;/strong&gt; {connectionData.Mentor_Email__c}&lt;/p&gt;\n                &lt;/div&gt;\n\n                &lt;!-- Track Selection --&gt;\n                &lt;template if:true={isCloudCoach}&gt;\n                  &lt;h3 style=\"text-align: center; margin-top: 1.5rem;\"&gt;Select Student Track&lt;/h3&gt;\n                  &lt;div class=\"track-toggle-row\"&gt;\n                    &lt;lightning-button label=\"Support Track\" variant={supportTrackVariant}\n                      onclick={selectSupportTrack}&gt;&lt;/lightning-button&gt;\n                    &lt;lightning-button label=\"Track 1\" variant={track1Variant} onclick={selectTrack1}&gt;&lt;/lightning-button&gt;\n                    &lt;lightning-button label=\"Track 2\" variant={track2Variant} onclick={selectTrack2}&gt;&lt;/lightning-button&gt;\n                    &lt;lightning-button label=\"Track 3\" variant={track3Variant} onclick={selectTrack3}&gt;&lt;/lightning-button&gt;\n                  &lt;/div&gt;\n                  &lt;div class=\"track-description\"&gt;\n                    &lt;p&gt;{trackDescription}&lt;/p&gt;\n                  &lt;/div&gt;\n                &lt;/template&gt;\n\n                &lt;!-- Week Availability --&gt;\n                &lt;h3 style=\"text-align: center; margin-top: 1.5rem;\"&gt;Set Out of Office&lt;/h3&gt;\n                &lt;div class=\"weeks-container two-column\"&gt;\n                  &lt;div class=\"week-column\"&gt;\n                    &lt;template for:each={weekListLeft} for:item=\"week\"&gt;\n                      &lt;div key={week.label} class=\"week-option\"&gt;\n                        &lt;lightning-input type=\"checkbox\" label={week.label} name={week.name} checked={week.checked}\n                          onchange={handleWeekToggle}&gt;&lt;/lightning-input&gt;\n                      &lt;/div&gt;\n                    &lt;/template&gt;\n                  &lt;/div&gt;\n                  &lt;div class=\"week-column\"&gt;\n                    &lt;template for:each={weekListRight} for:item=\"week\"&gt;\n                      &lt;div key={week.label} class=\"week-option\"&gt;\n                        &lt;lightning-input type=\"checkbox\" label={week.label} name={week.name} checked={week.checked}\n                          onchange={handleWeekToggle}&gt;&lt;/lightning-input&gt;\n                      &lt;/div&gt;\n                    &lt;/template&gt;\n                  &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"modal-footer\"&gt;\n                  &lt;lightning-button variant=\"brand\" label=\"Update Settings\"\n                    onclick={handleUpdateSettings}&gt;&lt;/lightning-button&gt;\n                  &lt;lightning-button variant=\"neutral\" label=\"Report an Error\"\n                    onclick={handleReportError}&gt;&lt;/lightning-button&gt;\n                &lt;/div&gt;\n                &lt;div class=\"modal-status\"&gt;\n                  &lt;p class=\"error\"&gt;{modalStatusMsg}&lt;/p&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/section&gt;\n        &lt;/template&gt;\n\n        &lt;!-- Sidebar Week Selection --&gt;\n        &lt;div class=\"sidebar\"&gt;\n          &lt;template for:each={weekOptions} for:item=\"opt\"&gt;\n            &lt;div key={opt.value} data-week={opt.value} onclick={handleWeekClick} class={opt.cssClass}&gt;\n              {opt.label}\n              &lt;template if:true={opt.isOverdue}&gt;\n                &lt;lightning-icon icon-name=\"utility:warning\" alternative-text=\"Overdue\" variant=\"warning\" size=\"xx-small\"\n                  class=\"slds-m-left_xx-small\"&gt;&lt;/lightning-icon&gt;\n              &lt;/template&gt;\n            &lt;/div&gt;\n          &lt;/template&gt;\n        &lt;/div&gt;\n\n        &lt;!-- Main Portal Content --&gt;\n        &lt;div class=\"main\"&gt;\n          &lt;!-- VAF Mode --&gt;\n          &lt;template if:true={isVAF}&gt;\n            &lt;h2&gt;BestPrep Volunteer Agreement Form&lt;/h2&gt;\n            &lt;p&gt;This form must be completed once per school year...&lt;/p&gt;\n\n            &lt;p&gt;&lt;strong&gt;Name:&lt;/strong&gt; {mentorFullName}&lt;/p&gt;\n            &lt;p&gt;&lt;strong&gt;Company:&lt;/strong&gt; {assignedCompany}&lt;/p&gt;\n            &lt;p&gt;&lt;strong&gt;Email:&lt;/strong&gt; {connectionData.Mentor_Email__c}&lt;/p&gt;\n\n            &lt;div class=\"form-section\"&gt;\n              &lt;label&gt;Pronouns (select all that apply):&lt;/label&gt;\n              &lt;lightning-checkbox-group name=\"pronouns\" options={pronounOptions} value={vafForm.pronouns}\n                onchange={handleCheckboxChange}&gt;&lt;/lightning-checkbox-group&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-section\"&gt;\n              &lt;lightning-combobox name=\"ethnicity\" label=\"Ethnicity\" value={vafForm.ethnicity}\n                options={ethnicityOptions} onchange={handleCheckboxChange}&gt;&lt;/lightning-combobox&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-section\"&gt;\n              &lt;p&gt;BestPrep requires all volunteers to...&lt;/p&gt;\n              &lt;a href=\"https://bestprep2018.wpenginepowered.com/wp-content/uploads/2023/10/BestPrep-Belief-Statements.pdf\"\n                target=\"_blank\"&gt;Belief Statements&lt;/a&gt;&lt;br&gt;\n              &lt;iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/EDA0RFlhW6Q\" frameborder=\"0\"\n                allowfullscreen&gt;&lt;/iframe&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-section\"&gt;\n              &lt;template for:each={vafCheckboxes} for:item=\"item\"&gt;\n                &lt;lightning-input key={item.name} type=\"checkbox\" name={item.name} label={item.label}\n                  onchange={handleCheckboxChange}&gt;&lt;/lightning-input&gt;\n              &lt;/template&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-actions\"&gt;\n              &lt;lightning-button variant=\"brand\" label=\"Submit\" onclick={handleVafSubmit}&gt;&lt;/lightning-button&gt;\n            &lt;/div&gt;\n\n            &lt;p class=\"error\"&gt;{statusMsg}&lt;/p&gt;\n          &lt;/template&gt;\n\n          &lt;!-- Survey Mode --&gt;\n          &lt;template if:true={isSurveyWeek}&gt;\n            &lt;h2&gt;Survey&lt;/h2&gt;\n            &lt;p&gt;Survey content goes here.&lt;/p&gt;\n          &lt;/template&gt;\n\n          &lt;!-- Weekly Message --&gt;\n          &lt;template if:false={isVAF}&gt;\n            &lt;template if:false={isSurveyWeek}&gt;\n              &lt;div class=\"week-header\"&gt;\n                &lt;h2&gt;{selectedWeek} - this message is assigned for {currentGuidingQuestion.dueDate}&lt;/h2&gt;\n                &lt;h3&gt;{currentGuidingQuestion.title}&lt;/h3&gt;\n                &lt;p&gt;{currentGuidingQuestion.talkingPoints}&lt;/p&gt;\n                &lt;p&gt;\n                  Your student's name is &lt;strong&gt;{studentFamiliarName}&lt;/strong&gt; at &lt;strong&gt;{assignedSchool}&lt;/strong&gt;.\n                  Please contact your BestPrep Coordinator if you have questions.\n                &lt;/p&gt;\n              &lt;/div&gt;\n\n              &lt;div class=\"messages-container\"&gt;\n                &lt;!-- Message Left --&gt;\n                &lt;div class=\"message-left\"&gt;\n                  &lt;h4&gt;{leftMessageLabel} Message&lt;/h4&gt;\n                  &lt;!-- Cloud Coach Left --&gt;\n                  &lt;template if:true={isCloudCoach}&gt;\n                    &lt;template if:true={mentorMessage}&gt;\n                      &lt;template if:true={mentorMessageNeedsReview}&gt;\n                        &lt;p class=\"info\"&gt;This message is pending manual review.&lt;/p&gt;\n                      &lt;/template&gt;\n                      &lt;template if:true={mentorFileLink}&gt;\n                        &lt;template if:true={isMentorFileProcessing}&gt;\n                          &lt;p&gt;&lt;lightning-icon icon-name=\"utility:spinner\" size=\"xx-small\"&gt;&lt;/lightning-icon&gt; Attachment\n                            Processing...&lt;/p&gt;\n                        &lt;/template&gt;\n                        &lt;template if:false={isMentorFileProcessing}&gt;\n                          &lt;p&gt;&lt;a href={mentorFileLink} target=\"_blank\"&gt;View Attachment&lt;/a&gt;&lt;/p&gt;\n                        &lt;/template&gt;\n                      &lt;/template&gt;\n                      &lt;div class=\"msg-box\" lwc:dom=\"manual\" data-id=\"mentorMsg\"&gt;&lt;/div&gt;\n                    &lt;/template&gt;\n                    &lt;template if:false={mentorMessage}&gt;\n                      &lt;template if:true={mentorCanWrite}&gt;\n                        &lt;template if:true={attachmentEnabled}&gt;\n                          &lt;label class=\"slds-form-element__label\"&gt;Attach a PDF file&lt;/label&gt;\n                          &lt;input type=\"file\" accept=\"application/pdf\" onchange={handleFileChange} /&gt;\n                        &lt;/template&gt;\n                        &lt;lightning-textarea value={messageBody} label=\" \" variant=\"label-hidden\"\n                          onchange={handleChange}&gt;&lt;/lightning-textarea&gt;&lt;br&gt;\n                        &lt;lightning-button variant=\"brand\" label=\"Submit\" onclick={handleSubmit}&gt;&lt;/lightning-button&gt;\n                      &lt;/template&gt;\n                      &lt;template if:false={mentorCanWrite}&gt;\n                        &lt;p class=\"info\"&gt;You can submit a message if your student hasn't written by\n                          {mentorCanWriteDateText}.&lt;/p&gt;\n                      &lt;/template&gt;\n                    &lt;/template&gt;\n                  &lt;/template&gt;\n\n                  &lt;!-- eMentors Left --&gt;\n                  &lt;template if:false={isCloudCoach}&gt;\n                    &lt;div class=\"msg-box\"&gt;\n                      &lt;template if:true={studentFileLink}&gt;\n                        &lt;p&gt;&lt;a href={studentFileLink} target=\"_blank\"&gt;View Attachment&lt;/a&gt;&lt;/p&gt;\n                      &lt;/template&gt;\n                      &lt;lightning-formatted-rich-text value={studentMessage}&gt;&lt;/lightning-formatted-rich-text&gt;\n                    &lt;/div&gt;\n                  &lt;/template&gt;\n                &lt;/div&gt;\n\n                &lt;!-- Message Right --&gt;\n                &lt;div class=\"message-right\"&gt;\n                  &lt;h4&gt;{rightMessageLabel} Message&lt;/h4&gt;\n\n                  &lt;!-- eMentors Right --&gt;\n                  &lt;template if:false={isCloudCoach}&gt;\n                    &lt;template if:true={mentorMessage}&gt;\n                      &lt;template if:true={mentorMessageNeedsReview}&gt;\n                        &lt;p class=\"info\"&gt;This message is pending manual review.&lt;/p&gt;\n                      &lt;/template&gt;\n                      &lt;template if:true={mentorFileLink}&gt;\n                        &lt;template if:true={isMentorFileProcessing}&gt;\n                          &lt;p&gt;&lt;lightning-icon icon-name=\"utility:spinner\" size=\"xx-small\"&gt;&lt;/lightning-icon&gt; Attachment\n                            Processing...&lt;/p&gt;\n                        &lt;/template&gt;\n                        &lt;template if:false={isMentorFileProcessing}&gt;\n                          &lt;p&gt;&lt;a href={mentorFileLink} target=\"_blank\"&gt;View Attachment&lt;/a&gt;&lt;/p&gt;\n                        &lt;/template&gt;\n                      &lt;/template&gt;\n                      &lt;div class=\"msg-box\" lwc:dom=\"manual\" data-id=\"mentorMsg\"&gt;&lt;/div&gt;\n                    &lt;/template&gt;\n                    &lt;template if:false={mentorMessage}&gt;\n                      &lt;template if:true={mentorCanWrite}&gt;\n                        &lt;template if:true={attachmentEnabled}&gt;\n                          &lt;label class=\"slds-form-element__label\"&gt;Attach a PDF file&lt;/label&gt;\n                          &lt;input type=\"file\" accept=\"application/pdf\" class=\"slds-input\" onchange={handleFileChange} /&gt;\n                        &lt;/template&gt;\n                        &lt;lightning-textarea value={messageBody} label=\" \" variant=\"label-hidden\"\n                          onchange={handleChange}&gt;&lt;/lightning-textarea&gt;&lt;br&gt;\n                        &lt;lightning-button variant=\"brand\" label=\"Submit\" onclick={handleSubmit}&gt;&lt;/lightning-button&gt;\n                      &lt;/template&gt;\n                      &lt;template if:false={mentorCanWrite}&gt;\n                        &lt;p class=\"info\"&gt;You can submit a message if your student hasn't written by\n                          {mentorCanWriteDateText}.&lt;/p&gt;\n                      &lt;/template&gt;\n                    &lt;/template&gt;\n                  &lt;/template&gt;\n\n                  &lt;!-- Cloud Coach Right --&gt;\n                  &lt;template if:true={isCloudCoach}&gt;\n                    &lt;template if:true={studentFileLink}&gt;\n                      &lt;p&gt;&lt;a href={studentFileLink} target=\"_blank\"&gt;View Attachment&lt;/a&gt;&lt;/p&gt;\n                    &lt;/template&gt;\n                    &lt;div class=\"msg-box\"&gt;\n                      &lt;lightning-formatted-rich-text value={studentMessage}&gt;&lt;/lightning-formatted-rich-text&gt;\n                    &lt;/div&gt;\n                  &lt;/template&gt;\n\n                  &lt;p class=\"error\"&gt;{statusMsg}&lt;/p&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/template&gt;\n          &lt;/template&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/template&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n</code></pre>"},{"location":"mentoring/mentor_portal/mentor_web/#mentorportalcss","title":"mentorPortal.css","text":"<pre><code>:host {\n  display: block;\n  font-family: \"Segoe UI\", Tahoma, sans-serif;\n  background-color: #f8f9fa;\n  color: #333;\n  min-height: 100vh;\n}\n\n.container {\n  display: flex;\n  width: 100%;\n  min-height: 100vh;\n}\n\n.sidebar {\n  width: 12%;\n  background-color: #fff;\n  padding: 0.5rem;\n  border-right: 1px solid #e0e0e0;\n}\n\n.sidebar-item {\n  margin: 0.25rem 0;\n  padding: 0.5rem 1rem;\n  border-radius: 5px;\n  cursor: pointer;\n  transition: background-color 0.2s ease;\n  color: #333;\n}\n\n.sidebar-item:hover {\n  background-color: #f0f0f0;\n}\n\n.sidebar-item.active-week {\n  background-color: #0070d2;\n  color: #fff;\n  font-weight: bold;\n}\n\n.sidebar-item.disabled {\n  color: #aaa;\n  cursor: default;\n}\n\n.main {\n  width: 88%;\n  padding: 2rem;\n}\n\n.week-header h2 {\n  margin-bottom: 0.25rem;\n}\n\n.week-header h3 {\n  margin: 0.5rem 0 0.25rem;\n}\n\n.week-header p {\n  margin: 0 0 1rem;\n}\n\n.messages-container {\n  display: flex;\n  gap: 2rem;\n  flex-wrap: wrap;\n}\n\n.message-left,\n.message-right {\n  flex: 1;\n  min-width: 300px;\n  background: #fff;\n  border: 1px solid #ddd;\n  border-radius: 6px;\n  padding: 1.5rem;\n\n}\n\n.msg-box {\n  white-space: pre-wrap;\n  background-color: #fdfdfd;\n  border: 1px solid #ddd;\n  padding: 0.75rem;\n  margin-top: 0.5rem;\n  border-radius: 6px;\n  min-height: 120px;\n}\n\n.form-section {\n  margin: 1.5rem 0;\n}\n\n.form-actions {\n  margin-top: 2rem;\n}\n\nlightning-textarea,\nlightning-checkbox-group,\nlightning-combobox,\nlightning-input {\n  margin-top: 0.5rem;\n  width: 100%;\n}\n\nlightning-button {\n  margin-top: 1rem;\n}\n\n.error {\n  color: #d32f2f;\n  font-size: 1rem;\n  padding: 1rem 0;\n  text-align: center;\n}\n\n.info {\n  margin-top: 1rem;\n  font-style: italic;\n  color: #666;\n}\n\n.spinner-wrapper {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 9999;\n  background: rgba(255, 255, 255, 0.8);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* === BUTTON GROUP === */\n.button-group-top {\n  position: fixed;\n  top: 12px;\n  right: 12px;\n  display: flex;\n  gap: 8px;\n  z-index: 999;\n}\n\n.button-group-top .info-button,\n.button-group-top .settings-button {\n  background: white;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  padding: 4px;\n  cursor: pointer;\n}\n\n/* === BACKDROP &amp; SHARED MODAL BASE === */\n.modal-backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  backdrop-filter: blur(4px);\n  background-color: rgba(0, 0, 0, 0.3);\n  z-index: 1000;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.settings-modal {\n  background-color: white;\n  padding: 2rem;\n  border-radius: 8px;\n  max-width: 90%;\n  width: 100%;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  position: relative;\n  transition: all 0.3s ease;\n}\n\n@media screen and (min-width: 768px) {\n  .settings-modal {\n    max-width: 50%;\n  }\n}\n\n.modal-header {\n  display: flex;\n  justify-content: flex-end;\n}\n\n.close-icon {\n  cursor: pointer;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: center;\n  gap: 1rem;\n  margin-top: 1.5rem;\n}\n\n.modal-status {\n  text-align: center;\n  margin-top: 1rem;\n}\n\n/* === INFO MODAL SPECIFIC === */\n.info-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  grid-template-rows: auto auto;\n  gap: 1.5rem;\n  width: 100%;\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.info-box {\n  background: #f9f9f9;\n  padding: 1rem;\n  border-radius: 6px;\n  height: 100%;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);\n}\n\n/* === SETTINGS MODAL SPECIFIC === */\n.modal-body {\n  text-align: center;\n  padding: 1rem;\n}\n\n.mentor-info {\n  margin: 1rem auto;\n  text-align: left;\n  max-width: 400px;\n}\n\n.weeks-container {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 0.5rem;\n  margin: 1rem auto;\n  max-width: 600px;\n}\n\n.weeks-container.two-column {\n  display: flex;\n  justify-content: space-between;\n  gap: 2rem;\n}\n\n.week-column {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.track-toggle-row {\n  display: flex;\n  justify-content: center;\n  gap: 0.5rem;\n  margin-top: 1rem;\n  flex-wrap: wrap;\n}\n\n.track-description {\n  text-align: center;\n  margin-top: 0.75rem;\n  color: #666;\n  font-style: italic;\n}\n\n.link-button {\n  display: inline-block;\n  padding: 8px 16px;\n  margin: 4px;\n  background-color: #0070d2;\n  color: white;\n  text-decoration: none;\n  border-radius: 4px;\n  font-size: 0.875rem;\n  text-align: center;\n}\n\n.link-button:hover {\n  background-color: #005fb2;\n}\n\n.easteregg-backdrop {\n  position: fixed;\n  top: 0; left: 0;\n  width: 100vw;\n  height: 100vh;\n  background-color: rgba(0, 0, 0, 0.5); /* 50% dim */\n  z-index: 9999;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  pointer-events: none; /* disable interaction outside modal */\n}\n\n.easteregg-wrapper {\n  width: 80vw;\n  aspect-ratio: 16 / 9;\n  background-color: black;\n  border-radius: 16px;\n  overflow: hidden;\n  border: 8px solid;\n  border-image: repeating-linear-gradient(\n    45deg,\n    red 0px,\n    red 10px,\n    black 10px,\n    black 20px\n  ) 8;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  pointer-events: auto; /* allow interaction inside modal */\n}\n\n.easteregg-svg {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n</code></pre>"},{"location":"mentoring/other_systems/other_flows/","title":"Other Flows","text":"<p>In addition to those that can be easily classified into either the flagging system or the email system, there are a few other pieces that make up the mentoring system. </p>"},{"location":"mentoring/other_systems/other_flows/#mentoring-update-teacher-portal-url","title":"Mentoring - Update Teacher Portal URL","text":"<p>The flow Mentoring - Update Teacher Portal URL is designed to populate the portal section on eMentors and Cloud Coach cases. The only true difference in the URL for teacher versus coordinator portal links is the addition of <code>&amp;user=teacher</code> on the end. In fact, if that tag is anything other than <code>teacher</code> it will display the coordinator portal. You can learn more about why here.</p> <p></p>   graph TD   N2[Record-Triggered Flow] --&gt; N3[Get Triggering Case Records]   N3 --&gt; N4[Create Coordinator Link]   N4 --&gt; N5[Update Coordinator Link]   N5 --&gt; N6[Create Teacher Link]   N6 --&gt; N7[Update Teacher Link]   N7 --&gt; N8[End]    N2 --&gt;|Error| N9[If An Error Happens]    class N2 click-step-N2;   class N3 click-step-N3;   class N4 click-step-N4;   class N5 click-step-N5;   class N6 click-step-N6;   class N7 click-step-N7;   class N9 click-step-N9;    classDef clickable stroke:#333,stroke-width:2px;   class N2,N3,N4,N5,N6,N7,N9 clickable;   \u00d7 Why <code>&amp;user=teacher</code> <p>It was an intentional decision to use <code>&amp;user=teacher</code> for the teacher portal, but not to use <code>&amp;user=coodinator</code> or <code>&amp;user=company</code> for the company coordinator portal.The main difference lies in that teachers have access to student messages, and they should be the only ones who do. While it isn't necessarily \"protected information\" it also isn't information that just anyone should be allowed to have.If a coordinator, or any other related party, recieved a link that ended in <code>&amp;user=coordinator</code>, it wouldn't be that difficult to realize that simply changing the user tag could change the view. The decision was made in line with our best practices to try and protect student data to a reasonable extent.</p> \u00d7 Record-Triggered Flow <p>This flow will trigger whenever a case is created OR updated and the RecordTypeId equals either eMentors (012A0000000z1RhIAI) or Cloud Coach (TBD).</p> \u00d7 Get Triggering Case Records <p>Get the case where <code>CaseId</code> equals that of the triggering case.</p> \u00d7 Create Coordinator Link <p>Using the case record that triggered the flow, create the coordinator link by adding each piece of the link to a variable that can then be easily changed:</p> <ul> <li>Add <code>https://mentoring.bestprep.org/s/connection-overview?caseId=</code> to variable <code>URL</code></li> <li>Add <code>CaseId</code> of the triggering case to variable <code>URL</code></li> <li>Add <code>&amp;PW=</code> to variable <code>URL</code></li> <li>Add <code>Case_Password__c</code> to variable <code>URL</code></li> </ul> \u00d7 Update Coordinator Link <p>Take the variable <code>URL</code> and update field <code>Coordinator_Portal_URL__c</code> on the triggering case.</p> \u00d7 Create Teacher Link <p>Using the case record that triggered the flow, create the teacher link by adding each piece of the link to a variable that can then be easily changed:</p> <ul> <li>Add <code>https://mentoring.bestprep.org/s/connection-overview?caseId=</code> to variable <code>URL</code></li> <li>Add <code>CaseId</code> of the triggering case to variable <code>URL</code></li> <li>Add <code>&amp;PW=</code> to variable <code>URL</code></li> <li>Add <code>Case_Password__c</code> to variable <code>URL</code></li> <li>Add <code>&amp;user=teacher</code> to variable <code>URL</code></li> </ul> \u00d7 Update Teacher Link <p>Take the variable <code>URL</code> and update field <code>Teacher_Portal_URL__c</code> on the triggering case.</p> \u00d7 Uh-oh... there was an error. <p>If for any reason an error should occur, Salesforce will not allow any user to save a case while the error is happening.</p>"},{"location":"mentoring/other_systems/overdue_app/","title":"Mentoring Overdue App","text":"<p>The Overdue App is the BestPrep way to monitor our mentoring connections within Salesforce \u2014 to see what mentors and students have written, completed their surveys, or may be overdue on messages. The app can be found in the Overview tab, which you can search for via the 9 dots in the upper left corner of the screen.</p> <p>By default, the app will attempt to load any open cases that you own which have the record type of either eMentors or Cloud Coach. If none exist, you will be met with an empty screen. This is the same screen you will see if you have an active case but no connection objects have yet been created.</p> <p></p> <p>If you would like to view a specific case that might not belong to you, you can do so using the selection dropdown on the right-hand side of the app. Cases in the dropdown are grouped by case owner. You can choose to view all cases for a specific staff member at once using the View All [Name] Cases option, or select a single specific case.</p> <p></p> <p>Once you have selected a case, the view will populate. You have the option to choose from two different overall views \u2014 either Mentors or Students \u2014 using the toggle buttons in the upper left. You can then further narrow what you see using the Class Period filter or the Only Show Overdue checkbox. Any changes you make to the on-screen filters will also apply to the file downloaded using the download feature.</p> <p></p> <p></p> <p>Each case is displayed as its own table, with the header showing the Case Subject and the Case Owner's name. The row count shown next to the case title reflects the number of connections currently visible given your active filters.</p>"},{"location":"mentoring/other_systems/overdue_app/#the-status-grid","title":"The Status Grid","text":"<p>Each row in the table represents one mentor-student connection. The columns are as follows:</p> <ul> <li>Primary name column \u2014 the name of the person whose view you are in (Mentor or Student), shown in bold and linked to the connection record in Salesforce</li> <li>Secondary name column \u2014 the paired person's name, shown in grey</li> <li>Week columns \u2014 one column per program week, labeled Week 1, Week 2, etc., with the due date shown in smaller italic text beneath the label</li> <li>Survey column(s) \u2014 one or two checkbox columns at the end depending on the view (see below)</li> </ul> <p>Each week cell displays one of four icons:</p> Icon Meaning \u2705 Green check The message was submitted. Hovering shows the submission date. \u274c Red X The message is overdue. Clicking opens a pre-filled email to the mentor or student. \u26a0\ufe0f Yellow warning The message is at risk \u2014 it is due soon but has not yet been written. Clicking opens a pre-filled reminder email. \u2022\u2022\u2022 Grey dots The week is not yet due. No action needed. \ud83d\udd18 Out of Office Symbole The mentor is marked as Out of Office for this week (see below)."},{"location":"mentoring/other_systems/overdue_app/#mentor-view","title":"Mentor View","text":"<p>The Mentor view shows one row per connection, with the mentor as the primary (bold) name and the student as the secondary (grey) name.</p> <p>For Cloud Coach cases, a mentor is considered overdue as soon as the week date has passed and they have not written their message. They are considered at risk if the due date is within 4 days and no message has been written yet.</p> <p>For eMentors cases, a mentor is considered overdue if their student has written a message and the mentor has not replied within 3 days.</p> <p>At the end of each row there is a Mentor Survey column showing whether the mentor has completed their end-of-program survey (green check = complete, red X = incomplete).</p>"},{"location":"mentoring/other_systems/overdue_app/#student-view","title":"Student View","text":"<p>The Student view shows one row per connection, with the student as the primary (bold) name and the mentor as the secondary (grey) name.</p> <p>A student is considered overdue if they have not written their week's message more than 3 days after the week date.</p> <p>For Cloud Coach cases, there are two survey columns at the end of each row:</p> <ul> <li>Pre-Survey \u2014 whether the student completed the pre-program survey</li> <li>Survey \u2014 whether the student completed the end-of-program survey</li> </ul> <p>For eMentors cases, only the Survey column is shown.</p>"},{"location":"mentoring/other_systems/overdue_app/#only-show-overdue-filter","title":"Only Show Overdue Filter","text":"<p>The Only Show Overdue checkbox (located in the top controls bar, next to the Class Period filter) limits the table to connections that currently require attention. The logic differs slightly by program type and view:</p> <p>Mentor view \u2014 Cloud Coach: Shows mentors who have not written the most recent due week's message, and are either past the due date or within 4 days of it.</p> <p>Mentor view \u2014 eMentors: Shows mentors who have not replied to their student's most recent message within 3 days.</p> <p>Student view (all types): Shows students who have not written the most recent due week's message and are more than 3 days past that week's due date.</p> <p>Important: Only the most recent active week is evaluated. A mentor or student who missed an earlier week but is current on the latest week will not appear in the overdue filter.</p>"},{"location":"mentoring/other_systems/overdue_app/#out-of-office","title":"Out of Office","text":"<p>If a mentor has been marked as Out of Office for a given week (set on the connection record in Salesforce), their week cell will display a grey out of office icon rather than a red X or yellow warning, and they will not be included in the overdue filter for that week.</p> <p>The one exception is the previous week fallback rule: if a mentor is out of office for the current week and also missed the previous week without being out of office for it, they will still appear in the overdue filter. This ensures that a sustained pattern of missed messages is not hidden by an out-of-office designation.</p>"},{"location":"mentoring/other_systems/overdue_app/#emailing-mentors-and-students","title":"Emailing Mentors and Students","text":"<p>Clicking a red X (overdue) or yellow warning (at risk) icon opens your default email client with a pre-filled message addressed to the mentor or student. The email includes:</p> <ul> <li>A personalized greeting using the mentor's or student's familiar name</li> <li>Context about which week is missing</li> <li>A direct link to their mentoring portal</li> <li>Your first name as the sign-off</li> </ul> <p>If you are viewing a case that belongs to another staff member (i.e., you used the dropdown to load someone else's case), the case owner will automatically be CC'd on any email you send from within the app.</p>"},{"location":"mentoring/other_systems/overdue_app/#downloading-a-csv","title":"Downloading a CSV","text":"<p>Clicking the download icon (top right of the app, only visible when data is loaded) gives you the option to download either all the connections on screen as separate files by case or as one combined file. The filename follows the format:</p> <pre><code>CaseSubject_OverdueMentors.csv\nCaseSubject_OverdueStudents.csv\nAllCases_OverdueMentors.csv\nAllCases_OverdueStudents.csv\n</code></pre> <p>The file only includes the connections currently visible on screen \u2014 if you have the Only Show Overdue filter active or a Class Period filter applied, only those rows will be exported. This makes the download immediately ready for tasks such as a mail merge in Outlook to all overdue mentors.</p> <p>Depending on the active view, the columns in the exported file differ:</p> <p>Mentor CSV:</p> Mentor Full Name Mentor Familiar Name Mentor Email Mentor Organization Week 1 Date Week 2 Date \u2026 Mentor Survey Complete Mentor Portal Link <p>Student CSV (Cloud Coach):</p> Student Full Name Student Familiar Name Student Email Student Pre-Survey Complete Week 1 Date Week 2 Date \u2026 Survey Complete Student Portal Link <p>Student CSV (eMentors):</p> Student Full Name Student Familiar Name Student Email Week 1 Date Week 2 Date \u2026 Survey Complete Student Portal Link <p>If you download a combined file, it will also include a column for case subject. </p> <p>Week date columns are labeled with the week name and date (e.g. <code>Week 1 (01/16/2026)</code>). A date value is only filled in for weeks where the message has been submitted; overdue or pending weeks are left blank.</p> <p></p>"},{"location":"mentoring/other_systems/overdue_app/#features-summary","title":"Features Summary","text":"<ul> <li>Mentor and Student views \u2014 toggle between the two perspectives using the button group in the top left</li> <li>Class Period filter \u2014 narrow the table to a single class period when a case has multiple periods</li> <li>Only Show Overdue \u2014 hide connections that are current and only surface those needing follow-up</li> <li>Out of Office awareness \u2014 mentors marked OOO for a week are shown with a grey icon and excluded from the overdue filter, unless they also missed the prior week without being OOO</li> <li>Click-to-email \u2014 red and yellow icons are clickable links that open a pre-addressed, pre-filled email in your default mail client; case owner is auto-CC'd if you are not the owner</li> <li>Survey status columns \u2014 at-a-glance checkboxes for mentor survey completion (mentor view) and student pre-survey and survey completion (student view)</li> <li>Case owner grouping \u2014 the dropdown groups cases by staff member, with a \"View All\" option per person</li> <li>CSV download \u2014 exports exactly what is on screen, with the option of either one file per case or combined, in a format ready for mail merge or reporting</li> <li>Case header \u2014 every table is labeled with both the case subject and the case owner's name so context is always clear when viewing multiple cases at once</li> </ul>"},{"location":"mentoring/other_systems/overdue_app/#code","title":"Code","text":"<p>Code for reference in the event it is no longer available on Salesforce. </p> <p>Apex <pre><code>public with sharing class MentoringOverdueController {\n\n    public class CaseWrapper {\n        @AuraEnabled public Id caseId;\n        @AuraEnabled public String subject;\n        @AuraEnabled public Date assignedStart;\n        @AuraEnabled public Date assignedEnd;\n        @AuraEnabled public List&lt;WeekDate&gt; ccDates;\n        @AuraEnabled public List&lt;ConnectionWrapper&gt; connections;\n        @AuraEnabled public Boolean isParentCase;\n        @AuraEnabled public String ownerFirstName;\n        @AuraEnabled public String ownerLastName;\n        @AuraEnabled public String ownerEmail;\n        @AuraEnabled public Id ownerId;\n    }\n\n    public class WeekDate {\n        @AuraEnabled public String week;\n        @AuraEnabled public Date weekDate;\n\n        public WeekDate(String w, Date d) {\n            this.week = w;\n            this.weekDate = d;\n        }\n    }\n\n    public class ConnectionWrapper {\n        @AuraEnabled public Id connectionId;\n        @AuraEnabled public String mentorName;\n        @AuraEnabled public String mentorFamiliarName;\n        @AuraEnabled public String mentorEmail;\n        @AuraEnabled public String studentName;\n        @AuraEnabled public String studentFamiliarName;\n        @AuraEnabled public String studentEmail;\n        @AuraEnabled public String classPeriod;\n        @AuraEnabled public String organization;\n        @AuraEnabled public String connectionType;\n        @AuraEnabled public String connectionPasskey;\n        @AuraEnabled public Boolean mentorSurveyCompleted;\n        @AuraEnabled public Boolean studentPreSurveyCompleted;\n        @AuraEnabled public Boolean studentSurveyCompleted;\n        @AuraEnabled public String mentorOutOfOffice;\n        @AuraEnabled public List&lt;MessageWrapper&gt; messages;\n    }\n\n    public class MessageWrapper {\n        @AuraEnabled public DateTime createdDate;\n        @AuraEnabled public String role;\n        @AuraEnabled public String week;\n    }\n\n    public class CaseOption {\n        @AuraEnabled public Id caseId;\n        @AuraEnabled public String subject;\n        @AuraEnabled public Id ownerId;\n        @AuraEnabled public String ownerFirstName;\n        @AuraEnabled public String ownerLastName;\n    }\n\n    /**\n     * Returns the running user's first name for use in email templates.\n     */\n    @AuraEnabled(cacheable=true)\n    public static String getCurrentUserFirstName() {\n        return UserInfo.getFirstName();\n    }\n\n    /**\n     * Returns the running user's Id.\n     */\n    @AuraEnabled(cacheable=true)\n    public static Id getCurrentUserId() {\n        return UserInfo.getUserId();\n    }\n\n    /**\n     * Returns the current user's owned cases that are active/assigned today.\n     */\n    @AuraEnabled(cacheable=true)\n    public static List&lt;CaseWrapper&gt; getCasesWithConnectionsAndMessages() {\n        Date today = Date.today();\n\n        List&lt;Case&gt; cases = [\n            SELECT Id, Subject, Status,\n                   Assigned_Start_Date__c, Assigned_End_Date__c,\n                   Is_Parent_Case__c,\n                   OwnerId,\n                   Owner.FirstName, Owner.LastName, Owner.Email,\n                   CC_Date_1__c, CC_Date_2__c, CC_Date_3__c, CC_Date_4__c,\n                   CC_Date_5__c, CC_Date_6__c, CC_Date_7__c, CC_Date_8__c,\n                   (SELECT Id, Deactivate__c, Mentor_Full_Name__c, Mentor_Familiar_Name__c, Mentor_Email__c,\n                           Student_Full_Name__c, Student_Familiar_Name__c, Student_Email__c,\n                           Class_Period__c, Mentor_Organization_Proper__c, Connection_Type__c,\n                           Connection_Passkey__c,\n                           Mentor_Survey_Completed__c,\n                           Student_PreSurvey_Completed__c,\n                           Student_Survey_Completed__c,\n                           Mentor_Out_of_Office__c,\n                           (SELECT CreatedDate, Role__c, Week__c FROM Messages__r)\n                    FROM Connections__r\n                    WHERE Deactivate__c = FALSE)\n            FROM Case\n            WHERE OwnerId = :UserInfo.getUserId()\n              AND Status = 'Assigned'\n              AND Assigned_Start_Date__c &lt;= :today\n              AND Assigned_End_Date__c &gt;= :today\n        ];\n\n        return buildWrappers(cases);\n    }\n\n    /**\n     * Returns a lightweight list of ALL currently-assigned eMentors / Cloud Coach cases\n     * grouped by owner \u2014 used to populate the \"browse other cases\" dropdown.\n     */\n    @AuraEnabled(cacheable=true)\n    public static List&lt;CaseOption&gt; getAssignedCaseOptions() {\n        Date today = Date.today();\n\n        List&lt;Case&gt; cases = [\n            SELECT Id, Subject, OwnerId, Owner.FirstName, Owner.LastName, Is_Parent_Case__c, RecordType.Name\n            FROM Case\n            WHERE Status = 'Assigned'\n              AND Assigned_Start_Date__c &lt;= :today\n              AND Assigned_End_Date__c &gt;= :today\n              AND RecordType.Name IN ('Cloud Coach', 'eMentors')\n              AND (RecordType.Name = 'eMentors' OR Is_Parent_Case__c = FALSE OR Is_Parent_Case__c = NULL)\n            ORDER BY Owner.LastName ASC, Owner.FirstName ASC, Subject ASC\n        ];\n\n        List&lt;CaseOption&gt; options = new List&lt;CaseOption&gt;();\n        for (Case c : cases) {\n            CaseOption opt = new CaseOption();\n            opt.caseId         = c.Id;\n            opt.subject        = c.Subject;\n            opt.ownerId        = c.OwnerId;\n            opt.ownerFirstName = c.Owner.FirstName;\n            opt.ownerLastName  = c.Owner.LastName;\n            options.add(opt);\n        }\n        return options;\n    }\n\n    /**\n     * Loads full case data (connections + messages) for a single case by Id.\n     */\n    @AuraEnabled(cacheable=true)\n    public static CaseWrapper getCaseDataById(Id caseId) {\n        List&lt;Case&gt; cases = [\n            SELECT Id, Subject, Status,\n                   Assigned_Start_Date__c, Assigned_End_Date__c,\n                   Is_Parent_Case__c,\n                   OwnerId,\n                   Owner.FirstName, Owner.LastName, Owner.Email,\n                   CC_Date_1__c, CC_Date_2__c, CC_Date_3__c, CC_Date_4__c,\n                   CC_Date_5__c, CC_Date_6__c, CC_Date_7__c, CC_Date_8__c,\n                   (SELECT Id, Deactivate__c, Mentor_Full_Name__c, Mentor_Familiar_Name__c, Mentor_Email__c,\n                           Student_Full_Name__c, Student_Familiar_Name__c, Student_Email__c,\n                           Class_Period__c, Mentor_Organization_Proper__c, Connection_Type__c,\n                           Connection_Passkey__c,\n                           Mentor_Survey_Completed__c,\n                           Student_PreSurvey_Completed__c,\n                           Student_Survey_Completed__c,\n                           Mentor_Out_of_Office__c,\n                           (SELECT CreatedDate, Role__c, Week__c FROM Messages__r)\n                    FROM Connections__r\n                    WHERE Deactivate__c = FALSE)\n            FROM Case\n            WHERE Id = :caseId\n            LIMIT 1\n        ];\n\n        if (cases.isEmpty()) return null;\n        List&lt;CaseWrapper&gt; wrapped = buildWrappers(cases);\n        return wrapped[0];\n    }\n\n    // \u2500\u2500\u2500 Private helpers \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    private static List&lt;CaseWrapper&gt; buildWrappers(List&lt;Case&gt; cases) {\n        List&lt;CaseWrapper&gt; result = new List&lt;CaseWrapper&gt;();\n\n        for (Case c : cases) {\n            CaseWrapper cw = new CaseWrapper();\n            cw.caseId       = c.Id;\n            cw.subject      = c.Subject;\n            cw.assignedStart = c.Assigned_Start_Date__c;\n            cw.assignedEnd   = c.Assigned_End_Date__c;\n            cw.isParentCase  = c.Is_Parent_Case__c;\n            cw.ownerId       = c.OwnerId;\n            cw.ownerFirstName = c.Owner.FirstName;\n            cw.ownerLastName  = c.Owner.LastName;\n            cw.ownerEmail     = c.Owner.Email;\n\n            cw.ccDates = new List&lt;WeekDate&gt;();\n            if (c.CC_Date_1__c != null) cw.ccDates.add(new WeekDate('Week 1', c.CC_Date_1__c));\n            if (c.CC_Date_2__c != null) cw.ccDates.add(new WeekDate('Week 2', c.CC_Date_2__c));\n            if (c.CC_Date_3__c != null) cw.ccDates.add(new WeekDate('Week 3', c.CC_Date_3__c));\n            if (c.CC_Date_4__c != null) cw.ccDates.add(new WeekDate('Week 4', c.CC_Date_4__c));\n            if (c.CC_Date_5__c != null) cw.ccDates.add(new WeekDate('Week 5', c.CC_Date_5__c));\n            if (c.CC_Date_6__c != null) cw.ccDates.add(new WeekDate('Week 6', c.CC_Date_6__c));\n            if (c.CC_Date_7__c != null) cw.ccDates.add(new WeekDate('Week 7', c.CC_Date_7__c));\n            if (c.CC_Date_8__c != null) cw.ccDates.add(new WeekDate('Week 8', c.CC_Date_8__c));\n\n            cw.connections = new List&lt;ConnectionWrapper&gt;();\n\n            for (Connection__c conn : c.Connections__r) {\n                if (conn.Connection_Type__c != 'eMentors' &amp;&amp; conn.Connection_Type__c != 'Cloud Coach') {\n                    continue;\n                }\n\n                ConnectionWrapper conWrap = new ConnectionWrapper();\n                conWrap.connectionId          = conn.Id;\n                conWrap.mentorName            = conn.Mentor_Full_Name__c;\n                conWrap.mentorFamiliarName     = conn.Mentor_Familiar_Name__c;\n                conWrap.mentorEmail           = conn.Mentor_Email__c;\n                conWrap.studentName           = conn.Student_Full_Name__c;\n                conWrap.studentFamiliarName   = conn.Student_Familiar_Name__c;\n                conWrap.studentEmail          = conn.Student_Email__c;\n                conWrap.classPeriod           = conn.Class_Period__c;\n                conWrap.organization          = conn.Mentor_Organization_Proper__c;\n                conWrap.connectionType        = conn.Connection_Type__c;\n                conWrap.connectionPasskey     = conn.Connection_Passkey__c;\n                conWrap.mentorSurveyCompleted       = conn.Mentor_Survey_Completed__c;\n                conWrap.studentPreSurveyCompleted   = conn.Student_PreSurvey_Completed__c;\n                conWrap.studentSurveyCompleted      = conn.Student_Survey_Completed__c;\n                conWrap.mentorOutOfOffice           = conn.Mentor_Out_of_Office__c;\n                conWrap.messages              = new List&lt;MessageWrapper&gt;();\n\n                for (Message__c msg : conn.Messages__r) {\n                    MessageWrapper mw = new MessageWrapper();\n                    mw.createdDate = msg.CreatedDate;\n                    mw.role        = msg.Role__c;\n                    mw.week        = msg.Week__c;\n                    conWrap.messages.add(mw);\n                }\n\n                cw.connections.add(conWrap);\n            }\n\n            result.add(cw);\n        }\n\n        return result;\n    }\n}\n</code></pre></p> <p>HTML <pre><code>&lt;template&gt;\n    &lt;lightning-card&gt;\n        &lt;div class=\"slds-m-around_medium\"&gt;\n\n            &lt;!-- \u2500\u2500 Top Controls Bar \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 --&gt;\n            &lt;div class=\"controls slds-grid slds-wrap slds-grid_align-spread slds-grid_vertical-align-center slds-m-bottom_small\"&gt;\n\n                &lt;!-- Left: View toggle + Class Period filter + Only Overdue checkbox --&gt;\n                &lt;div class=\"slds-grid slds-wrap slds-grid_vertical-align-center\" style=\"gap: 0.75rem;\"&gt;\n                    &lt;lightning-radio-group\n                        name=\"viewOptions\"\n                        label=\"View\"\n                        options={viewOptions}\n                        value={overdueView}\n                        onchange={handleViewChange}\n                        type=\"button\"&gt;\n                    &lt;/lightning-radio-group&gt;\n\n                    &lt;template if:true={hasClassPeriods}&gt;\n                        &lt;lightning-combobox\n                            name=\"classPeriod\"\n                            label=\"Class Period\"\n                            value={selectedClassPeriod}\n                            placeholder=\"All Periods\"\n                            options={classPeriodOptions}\n                            onchange={handleClassPeriodChange}\n                            style=\"min-width: 160px;\"&gt;\n                        &lt;/lightning-combobox&gt;\n                    &lt;/template&gt;\n\n                    &lt;!-- Only Show Overdue checkbox --&gt;\n                    &lt;div class=\"slds-form-element\" style=\"padding-top: 1.5rem;\"&gt;\n                        &lt;label class=\"slds-checkbox__label\" style=\"display:inline-flex;align-items:center;gap:0.4rem;cursor:pointer;\"&gt;\n                            &lt;input type=\"checkbox\" checked={showOnlyOverdue} onchange={handleOnlyOverdueChange} /&gt;\n                            &lt;span class=\"slds-text-body_small\"&gt;{onlyOverdueLabel}&lt;/span&gt;\n                        &lt;/label&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;!-- Right: Case dropdown + Download --&gt;\n                &lt;div class=\"slds-grid slds-grid_vertical-align-end\" style=\"gap: 0.5rem;\"&gt;\n                    &lt;template if:true={hasCaseOptions}&gt;\n                        &lt;lightning-combobox\n                            name=\"caseSelect\"\n                            label=\"View Case\"\n                            value={selectedCaseId}\n                            placeholder=\"Select a case\u2026\"\n                            options={caseSelectOptions}\n                            onchange={handleCaseSelect}\n                            style=\"min-width: 260px;\"&gt;\n                        &lt;/lightning-combobox&gt;\n                    &lt;/template&gt;\n\n                    &lt;!-- Download dropdown --&gt;\n                    &lt;template if:true={hasDisplayData}&gt;\n                        &lt;div class=\"download-dropdown-wrap\" style=\"padding-bottom: 2px; position: relative;\"&gt;\n                            &lt;button\n                                class=\"slds-button slds-button_icon slds-button_icon-border-filled\"\n                                onclick={handleDownloadToggle}\n                                title=\"Download as CSV\"&gt;\n                                &lt;lightning-icon icon-name=\"utility:download\" alternative-text=\"Download CSV\" size=\"small\"&gt;&lt;/lightning-icon&gt;\n                            &lt;/button&gt;\n                            &lt;template if:true={showDownloadMenu}&gt;\n                                &lt;div class=\"download-menu\" onclick={handleDownloadMenuClick}&gt;\n                                    &lt;ul class=\"slds-dropdown__list\" role=\"menu\"&gt;\n                                        &lt;li class=\"slds-dropdown__item\" role=\"presentation\"&gt;\n                                            &lt;a href=\"javascript:void(0);\" role=\"menuitem\" data-action=\"separate\" onclick={handleDownloadOption}&gt;\n                                                &lt;lightning-icon icon-name=\"utility:copy_to_clipboard\" size=\"x-small\" class=\"slds-m-right_x-small\"&gt;&lt;/lightning-icon&gt;\n                                                Download each case as a separate file\n                                            &lt;/a&gt;\n                                        &lt;/li&gt;\n                                        &lt;li class=\"slds-dropdown__item\" role=\"presentation\"&gt;\n                                            &lt;a href=\"javascript:void(0);\" role=\"menuitem\" data-action=\"combined\" onclick={handleDownloadOption}&gt;\n                                                &lt;lightning-icon icon-name=\"utility:merge\" size=\"x-small\" class=\"slds-m-right_x-small\"&gt;&lt;/lightning-icon&gt;\n                                                Download all cases in a single file\n                                            &lt;/a&gt;\n                                        &lt;/li&gt;\n                                    &lt;/ul&gt;\n                                &lt;/div&gt;\n                            &lt;/template&gt;\n                        &lt;/div&gt;\n                    &lt;/template&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n\n            &lt;!-- \u2500\u2500 Loading Spinner \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 --&gt;\n            &lt;template if:true={isLoading}&gt;\n                &lt;lightning-spinner alternative-text=\"Loading\" size=\"medium\"&gt;&lt;/lightning-spinner&gt;\n            &lt;/template&gt;\n\n            &lt;!-- \u2500\u2500 Error \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 --&gt;\n            &lt;template if:true={error}&gt;\n                &lt;div class=\"slds-text-color_error slds-m-bottom_medium\"&gt;\n                    &lt;p&gt;Error loading data: {error.body.message}&lt;/p&gt;\n                &lt;/div&gt;\n            &lt;/template&gt;\n\n            &lt;!-- \u2500\u2500 No user-owned cases prompt \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 --&gt;\n            &lt;template if:false={isLoading}&gt;\n                &lt;template if:true={showNoCasesMessage}&gt;\n                    &lt;div class=\"slds-text-align_center slds-m-vertical_large\"&gt;\n                        &lt;lightning-icon icon-name=\"utility:info\" size=\"small\" class=\"slds-m-right_x-small\"&gt;&lt;/lightning-icon&gt;\n                        &lt;span class=\"slds-text-heading_small slds-text-color_weak\"&gt;\n                            You have no active assigned cases. Select a case from the dropdown to view its data.\n                        &lt;/span&gt;\n                    &lt;/div&gt;\n                &lt;/template&gt;\n\n                &lt;!-- \u2500\u2500 Main data grid \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 --&gt;\n                &lt;template if:true={hasDisplayData}&gt;\n                    &lt;template for:each={displayGroups} for:item=\"caseGroup\"&gt;\n                        &lt;div key={caseGroup.caseId} class=\"slds-m-bottom_large\"&gt;\n\n                            &lt;!-- Case header: Subject \u2014 Owner --&gt;\n                            &lt;div class=\"slds-grid slds-grid_align-spread slds-grid_vertical-align-center\n                                        slds-p-bottom_x-small slds-m-bottom_small slds-border_bottom\"&gt;\n                                &lt;div class=\"slds-text-heading_medium\"&gt;\n                                    &lt;lightning-icon icon-name=\"standard:case\" size=\"small\" class=\"slds-m-right_x-small\"&gt;&lt;/lightning-icon&gt;\n                                    {caseGroup.caseTitle}\n                                    &lt;span class=\"slds-text-body_regular slds-text-color_weak\"&gt;({caseGroup.rows.length})&lt;/span&gt;\n                                &lt;/div&gt;\n                            &lt;/div&gt;\n\n                            &lt;!-- Status grid table --&gt;\n                            &lt;div class=\"status-table-wrap\"&gt;\n                                &lt;table class=\"status-table slds-table slds-table_bordered slds-table_fixed-layout\"&gt;\n                                    &lt;thead&gt;\n                                        &lt;tr&gt;\n                                            &lt;!-- Primary name column --&gt;\n                                            &lt;th class=\"col-name\"&gt;\n                                                &lt;template if:true={isMentorView}&gt;Mentor&lt;/template&gt;\n                                                &lt;template if:true={isStudentView}&gt;Student&lt;/template&gt;\n                                            &lt;/th&gt;\n                                            &lt;!-- Secondary name column --&gt;\n                                            &lt;th class=\"col-name\"&gt;\n                                                &lt;template if:true={isMentorView}&gt;Student&lt;/template&gt;\n                                                &lt;template if:true={isStudentView}&gt;Mentor&lt;/template&gt;\n                                            &lt;/th&gt;\n                                            &lt;!-- Week columns: \"Week N\" on top, date smaller/italic below --&gt;\n                                            &lt;template for:each={caseGroup.weekLabels} for:item=\"wl\"&gt;\n                                                &lt;th key={wl.label} class=\"col-week\"&gt;\n                                                    &lt;div&gt;{wl.label}&lt;/div&gt;\n                                                    &lt;div class=\"week-date-sub\"&gt;{wl.dateLabel}&lt;/div&gt;\n                                                &lt;/th&gt;\n                                            &lt;/template&gt;\n                                            &lt;!-- Mentor view: only Mentor Survey column --&gt;\n                                            &lt;template if:true={isMentorView}&gt;\n                                                &lt;th class=\"col-survey\"&gt;Mentor Survey&lt;/th&gt;\n                                            &lt;/template&gt;\n                                            &lt;!-- Student view: Pre-Survey (Cloud Coach only) + Survey --&gt;\n                                            &lt;template if:true={isStudentView}&gt;\n                                                &lt;template if:true={caseGroup.isCloudCoach}&gt;\n                                                    &lt;th class=\"col-survey\"&gt;Pre-Survey&lt;/th&gt;\n                                                &lt;/template&gt;\n                                                &lt;th class=\"col-survey\"&gt;Survey&lt;/th&gt;\n                                            &lt;/template&gt;\n                                        &lt;/tr&gt;\n                                    &lt;/thead&gt;\n                                    &lt;tbody&gt;\n                                        &lt;template for:each={caseGroup.rows} for:item=\"row\"&gt;\n                                            &lt;tr key={row.connectionId} class={row.rowClass}&gt;\n\n                                                &lt;!-- Primary name (bold, clickable) --&gt;\n                                                &lt;td class=\"col-name\" title={row.primaryName}&gt;\n                                                    &lt;a href={row.connectionUrl}\n                                                       target=\"_blank\"\n                                                       class=\"primary-name-link\"\n                                                       title={row.primaryName}&gt;\n                                                        {row.primaryName}\n                                                    &lt;/a&gt;\n                                                &lt;/td&gt;\n\n                                                &lt;!-- Secondary name (dimmed) --&gt;\n                                                &lt;td class=\"col-name\" title={row.secondaryName}&gt;\n                                                    &lt;span class=\"secondary-name\"&gt;{row.secondaryName}&lt;/span&gt;\n                                                &lt;/td&gt;\n\n                                                &lt;!-- Week status cells --&gt;\n                                                &lt;template for:each={row.weekStatuses} for:item=\"ws\"&gt;\n                                                    &lt;td key={ws.week} class=\"col-week cell-center\"&gt;\n\n                                                        &lt;template if:true={ws.isComplete}&gt;\n                                                            &lt;span class=\"icon-success\" title={ws.tooltip}&gt;\n                                                                &lt;lightning-icon icon-name=\"utility:success\" size=\"x-small\" alternative-text=\"Submitted\"&gt;&lt;/lightning-icon&gt;\n                                                            &lt;/span&gt;\n                                                        &lt;/template&gt;\n\n                                                        &lt;template if:true={ws.isOverdue}&gt;\n                                                            &lt;a href={ws.mailtoHref} class=\"icon-error icon-link\" title={ws.tooltip}&gt;\n                                                                &lt;lightning-icon icon-name=\"utility:error\" size=\"x-small\" alternative-text=\"Overdue \u2014 click to email\"&gt;&lt;/lightning-icon&gt;\n                                                            &lt;/a&gt;\n                                                        &lt;/template&gt;\n\n                                                        &lt;template if:true={ws.isAtRisk}&gt;\n                                                            &lt;a href={ws.mailtoHref} class=\"icon-warning icon-link\" title={ws.tooltip}&gt;\n                                                                &lt;lightning-icon icon-name=\"utility:warning\" size=\"x-small\" alternative-text=\"At Risk \u2014 click to email\"&gt;&lt;/lightning-icon&gt;\n                                                            &lt;/a&gt;\n                                                        &lt;/template&gt;\n\n                                                        &lt;template if:true={ws.isPending}&gt;\n                                                            &lt;span class=\"ellipsis-grey\" title={ws.tooltip}&gt;\u2022\u2022\u2022&lt;/span&gt;\n                                                        &lt;/template&gt;\n\n                                                        &lt;template if:true={ws.isOoo}&gt;\n                                                            &lt;span class=\"icon-ooo\" title={ws.tooltip}&gt;\n                                                                &lt;lightning-icon icon-name=\"utility:outcome\" size=\"x-small\" alternative-text=\"Mentor Out of Office\" variant=\"offline\"&gt;&lt;/lightning-icon&gt;\n                                                            &lt;/span&gt;\n                                                        &lt;/template&gt;\n\n                                                    &lt;/td&gt;\n                                                &lt;/template&gt;\n\n                                                &lt;!-- Mentor view: only Mentor Survey cell --&gt;\n                                                &lt;template if:true={isMentorView}&gt;\n                                                    &lt;td class=\"col-survey cell-center\"&gt;\n                                                        &lt;template if:true={row.mentorSurveyCompleted}&gt;\n                                                            &lt;span class=\"icon-success\"&gt;&lt;lightning-icon icon-name=\"utility:success\" size=\"x-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                                        &lt;/template&gt;\n                                                        &lt;template if:false={row.mentorSurveyCompleted}&gt;\n                                                            &lt;span class=\"icon-error\"&gt;&lt;lightning-icon icon-name=\"utility:error\" size=\"x-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                                        &lt;/template&gt;\n                                                    &lt;/td&gt;\n                                                &lt;/template&gt;\n\n                                                &lt;!-- Student view survey cells --&gt;\n                                                &lt;template if:true={isStudentView}&gt;\n                                                    &lt;template if:true={caseGroup.isCloudCoach}&gt;\n                                                        &lt;td class=\"col-survey cell-center\"&gt;\n                                                            &lt;template if:true={row.studentPreSurveyCompleted}&gt;\n                                                                &lt;span class=\"icon-success\"&gt;&lt;lightning-icon icon-name=\"utility:success\" size=\"x-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                                            &lt;/template&gt;\n                                                            &lt;template if:false={row.studentPreSurveyCompleted}&gt;\n                                                                &lt;span class=\"icon-error\"&gt;&lt;lightning-icon icon-name=\"utility:error\" size=\"x-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                                            &lt;/template&gt;\n                                                        &lt;/td&gt;\n                                                    &lt;/template&gt;\n                                                    &lt;td class=\"col-survey cell-center\"&gt;\n                                                        &lt;template if:true={row.studentSurveyCompleted}&gt;\n                                                            &lt;span class=\"icon-success\"&gt;&lt;lightning-icon icon-name=\"utility:success\" size=\"x-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                                        &lt;/template&gt;\n                                                        &lt;template if:false={row.studentSurveyCompleted}&gt;\n                                                            &lt;span class=\"icon-error\"&gt;&lt;lightning-icon icon-name=\"utility:error\" size=\"x-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                                        &lt;/template&gt;\n                                                    &lt;/td&gt;\n                                                &lt;/template&gt;\n\n                                            &lt;/tr&gt;\n                                        &lt;/template&gt;\n                                    &lt;/tbody&gt;\n                                &lt;/table&gt;\n                            &lt;/div&gt;\n\n                            &lt;!-- Legend --&gt;\n                            &lt;div class=\"legend\"&gt;\n                                &lt;span class=\"legend-item\"&gt;\n                                    &lt;span class=\"icon-success\"&gt;&lt;lightning-icon icon-name=\"utility:success\" size=\"xx-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt; Submitted\n                                &lt;/span&gt;\n                                &lt;span class=\"legend-item\"&gt;\n                                    &lt;span class=\"icon-error\"&gt;&lt;lightning-icon icon-name=\"utility:error\" size=\"xx-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt; Overdue\n                                &lt;/span&gt;\n                                &lt;span class=\"legend-item\"&gt;\n                                    &lt;span class=\"icon-warning\"&gt;&lt;lightning-icon icon-name=\"utility:warning\" size=\"xx-small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt; At Risk\n                                &lt;/span&gt;\n                                &lt;span class=\"ellipsis-grey legend-item\"&gt;\u2022\u2022\u2022 Pending&lt;/span&gt;\n                                &lt;span class=\"legend-item\"&gt;\n                                    &lt;span class=\"icon-ooo\"&gt;&lt;lightning-icon icon-name=\"utility:outcome\" size=\"xx-small\" variant=\"offline\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt; Out of Office\n                                &lt;/span&gt;\n                            &lt;/div&gt;\n\n                        &lt;/div&gt;\n                    &lt;/template&gt;\n                &lt;/template&gt;\n\n                &lt;!-- No data --&gt;\n                &lt;template if:false={hasDisplayData}&gt;\n                    &lt;template if:false={showNoCasesMessage}&gt;\n                        &lt;template if:false={isLoading}&gt;\n                            &lt;div class=\"slds-text-align_center slds-m-vertical_large\"&gt;\n                                &lt;span class=\"icon-success\"&gt;&lt;lightning-icon icon-name=\"utility:success\" size=\"small\"&gt;&lt;/lightning-icon&gt;&lt;/span&gt;\n                                &lt;span class=\"slds-text-heading_small slds-text-color_success\"&gt;\n                                    &lt;template if:true={isMentorView}&gt;No data to display for mentors.&lt;/template&gt;\n                                    &lt;template if:true={isStudentView}&gt;No data to display for students.&lt;/template&gt;\n                                &lt;/span&gt;\n                            &lt;/div&gt;\n                        &lt;/template&gt;\n                    &lt;/template&gt;\n                &lt;/template&gt;\n            &lt;/template&gt;\n\n        &lt;/div&gt;\n    &lt;/lightning-card&gt;\n&lt;/template&gt;\n</code></pre></p> <p>CSS <pre><code>.controls {\n    gap: 0.75rem;\n}\n\n/* \u2500\u2500 Status table \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 */\n.status-table-wrap {\n    overflow-x: auto;\n}\n\n.status-table {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 0.8125rem;\n}\n\n.status-table thead th {\n    background-color: #f3f3f3;\n    font-weight: 600;\n    text-align: center;\n    white-space: nowrap;\n    padding: 0.4rem 0.6rem;\n    border-bottom: 2px solid #dddbda;\n}\n\n.status-table thead th.col-name {\n    text-align: left;\n}\n\n/* Zebra striping \u2014 hover always wins */\n.status-table tbody tr.zebra-odd  { background-color: #ffffff; }\n.status-table tbody tr.zebra-even { background-color: #f7f8f9; }\n.status-table tbody tr:hover      { background-color: #eaf3fb !important; }\n\n.status-table tbody td {\n    padding: 0.35rem 0.5rem;\n    border-bottom: 1px solid #e9e8e8;\n    vertical-align: middle;\n}\n\n/* Narrower name columns */\n.col-name {\n    min-width: 110px;\n    max-width: 140px;\n    width: 130px;\n}\n\n.col-secondary {\n    color: #5a6872;\n}\n\n/* Wider week columns */\n.col-week {\n    width: 80px;\n    min-width: 80px;\n    text-align: center;\n}\n\n/* Survey columns */\n.col-survey {\n    width: 70px;\n    min-width: 70px;\n    text-align: center;\n    font-size: 0.75rem;\n}\n\n.cell-center {\n    text-align: center;\n}\n\n/* Week label two-line: \"Week 1\" bold + date smaller/italic below */\n.week-date-sub {\n    font-weight: 400;\n    font-style: italic;\n    font-size: 0.7rem;\n    color: #5a6872;\n    display: block;\n    white-space: nowrap;\n}\n\n.truncate {\n    display: block;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 135px;\n}\n\n/* Bold + link style for the primary (sorted-by) name */\n.primary-name-link {\n    font-weight: 700;\n    color: #0070d2;\n    text-decoration: none;\n    display: block;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 135px;\n}\n.primary-name-link:hover {\n    text-decoration: underline;\n    color: #005fb2;\n}\n\n/* Secondary name (dimmed) */\n.secondary-name {\n    display: block;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 135px;\n    color: #5a6872;\n}\n\n/* \u2500\u2500 Status icon colours \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500*/\n.icon-success {\n    --sds-c-icon-color-foreground-default: #2e844a;\n    display: inline-flex;\n}\n.icon-error {\n    --sds-c-icon-color-foreground-default: #c23934;\n    display: inline-flex;\n}\n.icon-warning {\n    --sds-c-icon-color-foreground-default: #dd7a01;\n    display: inline-flex;\n}\n.icon-ooo {\n    --sds-c-icon-color-foreground-default: #706e6b;\n    display: inline-flex;\n}\n\n.ellipsis-grey {\n    color: #adb5bd;\n    font-size: 0.85rem;\n    letter-spacing: 1px;\n}\n\n/* Clickable icon anchor (mailto) */\n.icon-link {\n    display: inline-flex;\n    cursor: pointer;\n    text-decoration: none;\n    border-radius: 4px;\n    padding: 1px;\n    transition: opacity 0.15s;\n}\n.icon-link:hover {\n    opacity: 0.75;\n}\n\n/* \u2500\u2500 Legend \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 */\n.legend {\n    display: flex;\n    gap: 1.2rem;\n    font-size: 0.75rem;\n    color: #5a6872;\n    flex-wrap: wrap;\n    margin-top: 0.4rem;\n}\n\n.legend-item {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.25rem;\n}\n\n/* \u2500\u2500 Download dropdown menu \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 */\n.download-dropdown-wrap {\n    position: relative;\n}\n\n.download-menu {\n    position: absolute;\n    top: calc(100% + 4px);\n    right: 0;\n    z-index: 9000;\n    background: #ffffff;\n    border: 1px solid #dddbda;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.16);\n    min-width: 260px;\n    padding: 0.25rem 0;\n}\n\n.download-menu .slds-dropdown__list {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n}\n\n.download-menu .slds-dropdown__item a {\n    display: flex;\n    align-items: center;\n    padding: 0.5rem 1rem;\n    font-size: 0.8125rem;\n    color: #080707;\n    text-decoration: none;\n    white-space: nowrap;\n    cursor: pointer;\n    transition: background-color 0.1s;\n}\n\n.download-menu .slds-dropdown__item a:hover {\n    background-color: #f3f3f3;\n    color: #0070d2;\n}\n</code></pre></p> <p>JavaScript <pre><code>import { LightningElement, wire, track } from 'lwc';\nimport getCasesWithConnectionsAndMessages from '@salesforce/apex/MentoringOverdueController.getCasesWithConnectionsAndMessages';\nimport getAssignedCaseOptions             from '@salesforce/apex/MentoringOverdueController.getAssignedCaseOptions';\nimport getCaseDataById                    from '@salesforce/apex/MentoringOverdueController.getCaseDataById';\nimport getCurrentUserFirstName            from '@salesforce/apex/MentoringOverdueController.getCurrentUserFirstName';\nimport getCurrentUserId                   from '@salesforce/apex/MentoringOverdueController.getCurrentUserId';\n\nconst SF_BASE_URL    = 'https://bestprep.lightning.force.com/lightning/r/Connection__c';\nconst MENTOR_PORTAL  = 'https://mentoring.bestprep.org/s/mentor-portal';\nconst STUDENT_PORTAL = 'https://mentoring.bestprep.org/s/student-portal';\n\nexport default class MentoringOverdue extends LightningElement {\n\n    // \u2500\u2500 Reactive state \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    @track overdueView        = 'mentors';\n    @track _isLoading         = true;\n    @track _isCaseLoading     = false;\n    @track error;\n\n    @track _userCases         = [];\n    @track _selectedCase      = null;\n    @track _caseOptions       = [];\n    @track _ownerCases        = null;\n\n    @track selectedCaseId      = '';\n    @track selectedClassPeriod = '';\n    @track showOnlyOverdue     = false;\n    @track showDownloadMenu    = false;\n\n    // \"View All &lt;owner&gt;\" selection \u2014 stores ownerId string\n    @track _selectedOwnerId    = '';\n\n    _userFirstName = '';\n    _currentUserId = null;\n\n    // \u2500\u2500 Wire: running user first name \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    @wire(getCurrentUserFirstName)\n    wiredUserFirstName({ data }) {\n        if (data != null) this._userFirstName = data;\n    }\n\n    // \u2500\u2500 Wire: running user id \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    @wire(getCurrentUserId)\n    wiredUserId({ data }) {\n        if (data != null) this._currentUserId = data;\n    }\n\n    // \u2500\u2500 Wire: user-owned cases \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    @wire(getCasesWithConnectionsAndMessages)\n    wiredUserCases({ error, data }) {\n        this._isLoading = true;\n        if (data) {\n            this._userCases = data;\n            this.error      = undefined;\n        } else if (error) {\n            this.error      = error;\n            this._userCases = [];\n        }\n        this._isLoading = false;\n    }\n\n    // \u2500\u2500 Wire: all assigned case options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    @wire(getAssignedCaseOptions)\n    wiredCaseOptions({ error, data }) {\n        if (data)  this._caseOptions = data;\n        else if (error) console.error('Error loading case options:', error);\n    }\n\n    // \u2500\u2500 Derived state \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    get isMentorView()  { return this.overdueView === 'mentors'; }\n    get isStudentView() { return this.overdueView === 'students'; }\n\n    get viewOptions() {\n        return [\n            { label: 'Mentors',  value: 'mentors' },\n            { label: 'Students', value: 'students' }\n        ];\n    }\n\n    get isLoading() { return this._isLoading || this._isCaseLoading; }\n\n    get hasCaseOptions() {\n        return this._caseOptions &amp;&amp; this._caseOptions.length &gt; 0;\n    }\n\n    get onlyOverdueLabel() {\n        return this.isMentorView ? 'Only Show Overdue Mentors' : 'Only Show Overdue Students';\n    }\n\n    /**\n     * Build grouped case dropdown options.\n     * Groups: \"\u2014 My Cases \u2014\" header, then each unique owner gets a header\n     * and a \"View All &lt;FirstName&gt; Cases\" option, followed by their individual cases.\n     */\n    get caseSelectOptions() {\n        const opts = [];\n        opts.push({ label: '\u2014 My Cases \u2014', value: '' });\n\n        const options = this._caseOptions || [];\n        const ownerMap = new Map();\n        for (const c of options) {\n            const key = c.ownerId;\n            if (!ownerMap.has(key)) {\n                ownerMap.set(key, {\n                    firstName: c.ownerFirstName || '',\n                    lastName:  c.ownerLastName  || '',\n                    cases: []\n                });\n            }\n            ownerMap.get(key).cases.push(c);\n        }\n\n        for (const [ownerId, ownerData] of ownerMap) {\n            const ownerLabel = `${ownerData.firstName} ${ownerData.lastName}`.trim();\n            opts.push({ label: `\u2500\u2500 ${ownerLabel} \u2500\u2500`, value: `__header__${ownerId}` });\n            opts.push({ label: `View All ${ownerData.firstName} Cases`, value: `__owner__${ownerId}` });\n            for (const c of ownerData.cases) {\n                opts.push({ label: c.subject, value: c.caseId });\n            }\n        }\n\n        return opts;\n    }\n\n    get _activeCaseData() {\n        return this._selectedCase ? [this._selectedCase] : this._userCases;\n    }\n\n    get hasClassPeriods() {\n        return this.classPeriodOptions.length &gt; 1;\n    }\n\n    get classPeriodOptions() {\n        const periods = new Set();\n        for (const c of this._activeCaseData) {\n            for (const conn of (c.connections || [])) {\n                if (conn.classPeriod) periods.add(conn.classPeriod);\n            }\n        }\n        const opts = [...periods].sort().map(p =&gt; ({ label: p, value: p }));\n        return [{ label: 'All Periods', value: '' }, ...opts];\n    }\n\n    get showNoCasesMessage() {\n        return !this.isLoading &amp;&amp; this._userCases.length === 0 &amp;&amp; this._selectedCase === null &amp;&amp; !this._selectedOwnerId;\n    }\n\n    // \u2500\u2500 Determine if a connection row is \"overdue\" for the current view \u2500\u2500\n    _isConnectionOverdue(conn, ccDates) {\n        const today    = this._today();\n        const messages = conn.messages || [];\n        const dates    = (ccDates || []).filter(d =&gt; this._parseDate(d.weekDate));\n\n        if (this.isMentorView) {\n            if (conn.connectionType === 'Cloud Coach') {\n                const arrivedDates = dates.filter(d =&gt; today &gt;= this._parseDate(d.weekDate));\n                if (arrivedDates.length === 0) return false;\n                const current   = arrivedDates[arrivedDates.length - 1];\n                const weekLabel = current.week;\n                const weekDate  = this._parseDate(current.weekDate);\n                if (messages.find(m =&gt; m.role === 'Mentor' &amp;&amp; m.week === weekLabel)) return false;\n                if (this._isMentorOoo(conn, weekLabel)) {\n                    return this._prevWeekMissedAndNotOoo(conn, arrivedDates, messages);\n                }\n                const daysUntil = this._daysBetween(today, weekDate);\n                return today &gt;= weekDate || daysUntil &lt;= 4;\n\n            } else if (conn.connectionType === 'eMentors') {\n                const studentMessages = messages\n                    .filter(m =&gt; m.role === 'Student')\n                    .sort((a, b) =&gt; new Date(b.createdDate) - new Date(a.createdDate));\n                if (studentMessages.length === 0) return false;\n                const latestStudentMsg = studentMessages[0];\n                const latestWeek = latestStudentMsg.week;\n                if (messages.find(m =&gt; m.role === 'Mentor' &amp;&amp; m.week === latestWeek)) return false;\n                if (this._isMentorOoo(conn, latestWeek)) {\n                    const olderStudentMsgs = studentMessages.filter(m =&gt; m.week !== latestWeek);\n                    if (olderStudentMsgs.length === 0) return false;\n                    const prevWeek = olderStudentMsgs[0].week;\n                    if (messages.find(m =&gt; m.role === 'Mentor' &amp;&amp; m.week === prevWeek)) return false;\n                    return !this._isMentorOoo(conn, prevWeek);\n                }\n                const studentDate = this._parseDateTime(latestStudentMsg.createdDate);\n                studentDate.setHours(0, 0, 0, 0);\n                return this._daysBetween(studentDate, today) &gt; 3;\n            }\n            return false;\n\n        } else {\n            const arrivedDates = dates.filter(d =&gt; today &gt;= this._parseDate(d.weekDate));\n            if (arrivedDates.length === 0) return false;\n            const current   = arrivedDates[arrivedDates.length - 1];\n            const weekLabel = current.week;\n            const weekDate  = this._parseDate(current.weekDate);\n            if (messages.find(m =&gt; m.role === 'Student' &amp;&amp; m.week === weekLabel)) return false;\n            const dueDate = new Date(weekDate);\n            dueDate.setDate(dueDate.getDate() + 3);\n            return today &gt; dueDate;\n        }\n    }\n\n    /** Returns true if the mentor's OOO picklist includes the given weekLabel. */\n    _isMentorOoo(conn, weekLabel) {\n        if (!conn.mentorOutOfOffice || !weekLabel) return false;\n        return conn.mentorOutOfOffice.split(';').map(s =&gt; s.trim()).includes(weekLabel);\n    }\n\n    _prevWeekMissedAndNotOoo(conn, arrivedDates, messages) {\n        if (arrivedDates.length &lt; 2) return false;\n        const prev      = arrivedDates[arrivedDates.length - 2];\n        const prevLabel = prev.week;\n        if (messages.find(m =&gt; m.role === 'Mentor' &amp;&amp; m.week === prevLabel)) return false;\n        return !this._isMentorOoo(conn, prevLabel);\n    }\n\n    // \u2500\u2500 Main display groups \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    get displayGroups() {\n        const groups = [];\n        const today  = this._today();\n\n        let casesToUse = this._selectedCase ? [this._selectedCase] : this._userCases;\n        if (this._ownerCases &amp;&amp; this._ownerCases.length &gt; 0) {\n            casesToUse = this._ownerCases;\n        }\n\n        const cases = [...casesToUse].sort((a, b) =&gt;\n            (a.subject || '').localeCompare(b.subject || '')\n        );\n\n        for (const caseRecord of cases) {\n            if (!caseRecord.connections || caseRecord.connections.length === 0) continue;\n\n            const weekLabels = (caseRecord.ccDates || []).map(d =&gt; {\n                const parsed = this._parseDate(d.weekDate);\n                return {\n                    label:     d.week,\n                    dateLabel: parsed ? this._fmt(parsed) : ''\n                };\n            });\n\n            let connections = [...caseRecord.connections];\n            if (this.selectedClassPeriod) {\n                connections = connections.filter(c =&gt; c.classPeriod === this.selectedClassPeriod);\n            }\n            if (this.showOnlyOverdue) {\n                connections = connections.filter(c =&gt; this._isConnectionOverdue(c, caseRecord.ccDates));\n            }\n\n            const primaryKey   = this.isMentorView ? 'mentorName' : 'studentName';\n            const secondaryKey = this.isMentorView ? 'studentName' : 'mentorName';\n            connections.sort((a, b) =&gt; {\n                const p = (a[primaryKey] || '').localeCompare(b[primaryKey] || '');\n                return p !== 0 ? p : (a[secondaryKey] || '').localeCompare(b[secondaryKey] || '');\n            });\n\n            const isCloudCoach = connections.some(c =&gt; c.connectionType === 'Cloud Coach');\n            const caseOwnerName = `${caseRecord.ownerFirstName || ''} ${caseRecord.ownerLastName || ''}`.trim();\n            const caseOwnerEmail = caseRecord.ownerEmail || '';\n            const isOwnedByCurrentUser = caseRecord.ownerId === this._currentUserId;\n\n            const rows = connections.map((conn, idx) =&gt; {\n                const mentorPortalLink  = `${MENTOR_PORTAL}?connectionId=${conn.connectionId}&amp;passkey=${conn.connectionPasskey || ''}`;\n                const studentPortalLink = `${STUDENT_PORTAL}?connectionId=${conn.connectionId}&amp;passkey=${conn.connectionPasskey || ''}`;\n\n                const weekStatuses = (caseRecord.ccDates || []).map(ccDate =&gt;\n                    this._getWeekStatus(conn, ccDate, today, mentorPortalLink, studentPortalLink, isOwnedByCurrentUser, caseOwnerEmail)\n                );\n\n                return {\n                    connectionId:  conn.connectionId,\n                    primaryName:   conn[primaryKey]   || '',\n                    secondaryName: conn[secondaryKey] || '',\n                    connectionUrl: `${SF_BASE_URL}/${conn.connectionId}/view`,\n                    rowClass:      idx % 2 === 0 ? 'zebra-odd' : 'zebra-even',\n                    mentorSurveyCompleted:     conn.mentorSurveyCompleted,\n                    studentSurveyCompleted:    conn.studentSurveyCompleted,\n                    studentPreSurveyCompleted: conn.studentPreSurveyCompleted,\n                    connectionType: conn.connectionType,\n                    _conn: conn,\n                    weekStatuses\n                };\n            });\n\n            if (rows.length &gt; 0) {\n                groups.push({\n                    caseId:      caseRecord.caseId,\n                    caseSubject: caseRecord.subject,\n                    caseOwnerName,\n                    caseOwnerEmail,\n                    caseTitle:   caseOwnerName ? `${caseRecord.subject} \u2014 ${caseOwnerName}` : caseRecord.subject,\n                    isCloudCoach,\n                    weekLabels,\n                    ccDates:     caseRecord.ccDates || [],\n                    rows\n                });\n            }\n        }\n        return groups;\n    }\n\n    get hasDisplayData() {\n        return this.displayGroups &amp;&amp; this.displayGroups.length &gt; 0;\n    }\n\n    // \u2500\u2500 Per-week status \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    _getWeekStatus(conn, ccDate, today, mentorPortalLink, studentPortalLink, isOwnedByCurrentUser, caseOwnerEmail) {\n        const messages  = conn.messages || [];\n        const connType  = conn.connectionType;\n        const weekLabel = ccDate.week;\n        const role      = this.isMentorView ? 'Mentor' : 'Student';\n\n        const existingMsg = messages.find(m =&gt; m.role === role &amp;&amp; m.week === weekLabel);\n        if (existingMsg) {\n            const submitted = this._fmtDateTime(existingMsg.createdDate);\n            return this._status('complete', weekLabel, `${role} submitted ${weekLabel} on ${submitted}`);\n        }\n\n        const weekDate = this._parseDate(ccDate.weekDate);\n        if (!weekDate) {\n            return this._status('pending', weekLabel, `${weekLabel}: no date configured`);\n        }\n\n        if (this.isMentorView) {\n            return this._mentorStatus(conn, weekDate, today, weekLabel, connType, messages, mentorPortalLink, isOwnedByCurrentUser, caseOwnerEmail);\n        } else {\n            return this._studentStatus(conn, weekDate, today, weekLabel, studentPortalLink, isOwnedByCurrentUser, caseOwnerEmail);\n        }\n    }\n\n    _mentorStatus(conn, weekDate, today, weekLabel, connType, messages, mentorPortalLink, isOwnedByCurrentUser, caseOwnerEmail) {\n        const mentorFirst  = conn.mentorFamiliarName || conn.mentorName || '';\n        const studentFirst = conn.studentFamiliarName || conn.studentName || '';\n        const mentorEmail  = conn.mentorEmail || '';\n        const signer       = this._userFirstName || '';\n\n        if (connType === 'Cloud Coach') {\n            if (today &gt;= weekDate) {\n                if (this._isMentorOoo(conn, weekLabel)) {\n                    return this._status('ooo', weekLabel, `${weekLabel}: mentor is out of office`);\n                }\n                const daysPast = this._daysBetween(weekDate, today);\n                const body = `Hi ${mentorFirst},\\n\\nI noticed you haven't gotten a chance yet to write your ${weekLabel} message to your student, ${studentFirst} quite yet. I just wanted to check in and see if there is anything I can do to support you!\\n\\nOur research has shown us over and over again how important it is for these students to have a mentor consistently showing up reliably on time in their lives - even if they aren't writing their messages back, they are reading your message! This message was due on ${this._fmt(weekDate)}, and so if you could please write your message as soon as possible, that would be fantastic.\\n\\nIf there is anything I can do to help you, please let me know. Here is your portal link: ${mentorPortalLink}.\\n\\nSincerely,\\n${signer}`;\n                return this._status('overdue', weekLabel,\n                    `No mentor message for ${weekLabel} (due ${this._fmt(weekDate)}, ${daysPast} day${daysPast === 1 ? '' : 's'} overdue)`,\n                    this._mailto(mentorEmail, `Checking in \u2014 ${weekLabel} Message`, body, isOwnedByCurrentUser ? null : caseOwnerEmail));\n            }\n            const daysUntil = this._daysBetween(today, weekDate);\n            if (daysUntil &lt;= 4) {\n                if (this._isMentorOoo(conn, weekLabel)) {\n                    return this._status('ooo', weekLabel, `${weekLabel}: mentor is out of office`);\n                }\n                const body = `Hi ${mentorFirst},\\n\\nI noticed you haven't gotten a chance yet to write your ${weekLabel} message to your student, ${studentFirst} quite yet. I just wanted to check in and see if there is anything I can do to support you!\\n\\nOur research has shown us over and over again how important it is for these students to have a mentor consistently showing up reliably on time in their lives - even if they aren't writing their messages back, they are reading your message!\\n\\nIf there is anything I can do to help you, please let me know. Here is your portal link: ${mentorPortalLink}.\\n\\nSincerely,\\n${signer}`;\n                return this._status('at_risk', weekLabel,\n                    `${weekLabel} due ${this._fmt(weekDate)} (${daysUntil} day${daysUntil === 1 ? '' : 's'} away)`,\n                    this._mailto(mentorEmail, `Friendly Reminder \u2014 ${weekLabel} Message Due Soon`, body, isOwnedByCurrentUser ? null : caseOwnerEmail));\n            }\n            return this._status('pending', weekLabel, `${weekLabel} due ${this._fmt(weekDate)}`);\n        }\n\n        if (connType === 'eMentors') {\n            const studentMsg = messages\n                .filter(m =&gt; m.role === 'Student' &amp;&amp; m.week === weekLabel)\n                .sort((a, b) =&gt; new Date(b.createdDate) - new Date(a.createdDate))[0];\n\n            if (!studentMsg) {\n                return this._status('pending', weekLabel, `${weekLabel}: awaiting student message`);\n            }\n\n            const studentDate = this._parseDateTime(studentMsg.createdDate);\n            studentDate.setHours(0, 0, 0, 0);\n            const daysSince = this._daysBetween(studentDate, today);\n\n            if (daysSince &gt; 3) {\n                if (this._isMentorOoo(conn, weekLabel)) {\n                    return this._status('ooo', weekLabel, `${weekLabel}: mentor is out of office`);\n                }\n                const body = `Hi ${mentorFirst},\\n\\nI noticed that your student, ${studentFirst} recently messaged you and you haven't gotten a chance to reply to them yet. Our research has consistently shown us that one of the most vital parts of this program is for a student to have a consistent mentor in their lives, even if just for a few weeks.\\n\\nIf there is anything I can do to help you, please let me know - otherwise, I look forward to seeing your message to ${studentFirst} come through soon. Here is your portal link: ${mentorPortalLink}.\\n\\nSincerely,\\n${signer}`;\n                return this._status('overdue', weekLabel,\n                    `Student wrote ${weekLabel} on ${this._fmt(studentDate)}, no mentor reply (${daysSince} days)`,\n                    this._mailto(mentorEmail, `Checking in \u2014 Reply to ${studentFirst}`, body, isOwnedByCurrentUser ? null : caseOwnerEmail));\n            }\n            const remaining = 3 - daysSince;\n            return this._status('pending', weekLabel,\n                `Student wrote ${weekLabel} on ${this._fmt(studentDate)}, ${remaining} day${remaining === 1 ? '' : 's'} remaining for mentor reply`);\n        }\n\n        return this._status('pending', weekLabel, '');\n    }\n\n    _studentStatus(conn, weekDate, today, weekLabel, studentPortalLink, isOwnedByCurrentUser, caseOwnerEmail) {\n        const studentFirst = conn.studentFamiliarName || conn.studentName || '';\n        const studentEmail = conn.studentEmail || '';\n        const signer       = this._userFirstName || '';\n\n        const dueDate = new Date(weekDate);\n        dueDate.setDate(dueDate.getDate() + 3);\n\n        if (today &gt; dueDate) {\n            const daysPast = this._daysBetween(dueDate, today);\n            const body = `Hi ${studentFirst},\\n\\nIt looks like you haven't had a chance to write your message for ${weekLabel} quite yet! It's really important, both for your grade and for your personal growth, that you participate in this program on time in a meaningful way.\\n\\nIf you need some extra help writing your message, please let your teacher know. Here is your portal link: ${studentPortalLink}.\\n\\nSincerely,\\n${signer}`;\n            return this._status('overdue', weekLabel,\n                `No student message for ${weekLabel} (due ${this._fmt(dueDate)}, ${daysPast} day${daysPast === 1 ? '' : 's'} overdue)`,\n                this._mailto(studentEmail, `Checking in \u2014 ${weekLabel} Message`, body, isOwnedByCurrentUser ? null : caseOwnerEmail));\n        }\n\n        if (today &gt;= weekDate) {\n            const daysLeft = this._daysBetween(today, dueDate);\n            const body = `Hi ${studentFirst},\\n\\nIt looks like you haven't had a chance to write your message for ${weekLabel} quite yet! It's really important, both for your grade and for your personal growth, that you participate in this program on time in a meaningful way.\\n\\nIf you need some extra help writing your message, please let your teacher know. Here is your portal link: ${studentPortalLink}.\\n\\nSincerely,\\n${signer}`;\n            return this._status('at_risk', weekLabel,\n                `Student ${weekLabel} due by ${this._fmt(dueDate)} (${daysLeft} day${daysLeft === 1 ? '' : 's'} left)`,\n                this._mailto(studentEmail, `Friendly Reminder \u2014 ${weekLabel} Message Due Soon`, body, isOwnedByCurrentUser ? null : caseOwnerEmail));\n        }\n\n        return this._status('pending', weekLabel, `${weekLabel} not yet due (${this._fmt(weekDate)})`);\n    }\n\n    // \u2500\u2500 Status helper \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    _status(type, week, tooltip, mailtoHref) {\n        return {\n            week,\n            isComplete:  type === 'complete',\n            isOverdue:   type === 'overdue',\n            isAtRisk:    type === 'at_risk',\n            isPending:   type === 'pending',\n            isOoo:       type === 'ooo',\n            tooltip,\n            mailtoHref:  mailtoHref || null,\n            isClickable: !!mailtoHref\n        };\n    }\n\n    /** Build a mailto: href with pre-filled subject, body, and optional CC. */\n    _mailto(to, subject, body, cc) {\n        let href = `mailto:${to}?subject=${encodeURIComponent(subject)}&amp;body=${encodeURIComponent(body)}`;\n        if (cc) href += `&amp;cc=${encodeURIComponent(cc)}`;\n        return href;\n    }\n\n    // \u2500\u2500 Event handlers \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    handleViewChange(event) {\n        this.overdueView = event.detail.value;\n        this.showDownloadMenu = false;\n    }\n\n    handleClassPeriodChange(event) {\n        this.selectedClassPeriod = event.detail.value;\n    }\n\n    handleOnlyOverdueChange(event) {\n        this.showOnlyOverdue = event.target.checked;\n    }\n\n    handleDownloadToggle(event) {\n        event.stopPropagation();\n        this.showDownloadMenu = !this.showDownloadMenu;\n        if (this.showDownloadMenu) {\n            // Close menu when clicking anywhere outside\n            const closeMenu = () =&gt; {\n                this.showDownloadMenu = false;\n                window.removeEventListener('click', closeMenu);\n            };\n            window.addEventListener('click', closeMenu);\n        }\n    }\n\n    handleDownloadMenuClick(event) {\n        // Prevent the window click listener from immediately closing the menu\n        event.stopPropagation();\n    }\n\n    handleDownloadOption(event) {\n        const action = event.currentTarget.dataset.action;\n        this.showDownloadMenu = false;\n        if (action === 'separate') {\n            this._downloadSeparate();\n        } else if (action === 'combined') {\n            this._downloadCombined();\n        }\n    }\n\n    handleCaseSelect(event) {\n        const value = event.detail.value;\n        this.selectedCaseId      = value;\n        this.selectedClassPeriod = '';\n        this._selectedCase       = null;\n        this._ownerCases         = null;\n        this._selectedOwnerId    = '';\n        this.showDownloadMenu    = false;\n\n        if (!value) return;\n\n        // \"View All owner\" option\n        if (value.startsWith('__owner__')) {\n            const ownerId = value.replace('__owner__', '');\n            this._selectedOwnerId = ownerId;\n            const ownerCaseIds = (this._caseOptions || [])\n                .filter(c =&gt; c.ownerId === ownerId)\n                .map(c =&gt; c.caseId);\n\n            this._isCaseLoading = true;\n            this._ownerCases    = [];\n            let loaded = 0;\n            const tempCases = [];\n\n            if (ownerCaseIds.length === 0) {\n                this._isCaseLoading = false;\n                return;\n            }\n\n            ownerCaseIds.forEach(caseId =&gt; {\n                getCaseDataById({ caseId })\n                    .then(data =&gt; {\n                        if (data) tempCases.push(data);\n                        loaded++;\n                        if (loaded === ownerCaseIds.length) {\n                            this._ownerCases    = tempCases;\n                            this._isCaseLoading = false;\n                        }\n                    })\n                    .catch(err =&gt; {\n                        console.error('Error loading case:', err);\n                        loaded++;\n                        if (loaded === ownerCaseIds.length) {\n                            this._isCaseLoading = false;\n                        }\n                    });\n            });\n            return;\n        }\n\n        // Header rows \u2014 ignore\n        if (value.startsWith('__header__')) {\n            this.selectedCaseId = '';\n            return;\n        }\n\n        // Single case\n        this._isCaseLoading = true;\n        getCaseDataById({ caseId: value })\n            .then(data =&gt; {\n                this._selectedCase  = data;\n                this._isCaseLoading = false;\n            })\n            .catch(err =&gt; {\n                console.error('Error loading case:', err);\n                this.error          = err;\n                this._isCaseLoading = false;\n            });\n    }\n\n    // \u2500\u2500 CSV download \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    /**\n     * Build the data rows for a single case group.\n     * includeCaseSubject = true prepends a \"Case Subject\" column (for combined file).\n     */\n    _buildGroupRows(group, includeCaseSubject) {\n        const weekDateHeaders = group.weekLabels.map(wl =&gt; `${wl.label} (${wl.dateLabel})`);\n        const allRows = [];\n\n        if (this.isMentorView) {\n            const headers = [\n                ...(includeCaseSubject ? ['Case Subject'] : []),\n                'Mentor Full Name', 'Mentor Familiar Name', 'Mentor Email',\n                'Mentor Organization',\n                ...weekDateHeaders,\n                'Mentor Survey Complete',\n                'Mentor Portal Link'\n            ];\n            allRows.push(headers);\n\n            for (const row of group.rows) {\n                const conn = row._conn;\n                const mentorLink = `${MENTOR_PORTAL}?connectionId=${conn.connectionId}&amp;passkey=${conn.connectionPasskey || ''}`;\n                const weekCols = row.weekStatuses.map(ws =&gt; {\n                    if (ws.isComplete) {\n                        const msg = (conn.messages || []).find(m =&gt; m.role === 'Mentor' &amp;&amp; m.week === ws.week);\n                        return msg ? this._fmtDateTime(msg.createdDate) : '';\n                    }\n                    return '';\n                });\n                allRows.push([\n                    ...(includeCaseSubject ? [group.caseSubject || ''] : []),\n                    conn.mentorName        || '',\n                    conn.mentorFamiliarName || '',\n                    conn.mentorEmail        || '',\n                    conn.organization       || '',\n                    ...weekCols,\n                    conn.mentorSurveyCompleted ? 'Yes' : 'No',\n                    mentorLink\n                ]);\n            }\n        } else {\n            const isCC = group.isCloudCoach;\n            const headers = [\n                ...(includeCaseSubject ? ['Case Subject'] : []),\n                'Student Full Name', 'Student Familiar Name', 'Student Email',\n                ...(isCC ? ['Student Pre-Survey Complete (Only Cloud Coach)'] : []),\n                ...weekDateHeaders,\n                'Survey Complete',\n                'Student Portal Link'\n            ];\n            allRows.push(headers);\n\n            for (const row of group.rows) {\n                const conn = row._conn;\n                const studentLink = `${STUDENT_PORTAL}?connectionId=${conn.connectionId}&amp;passkey=${conn.connectionPasskey || ''}`;\n                const weekCols = row.weekStatuses.map(ws =&gt; {\n                    if (ws.isComplete) {\n                        const msg = (conn.messages || []).find(m =&gt; m.role === 'Student' &amp;&amp; m.week === ws.week);\n                        return msg ? this._fmtDateTime(msg.createdDate) : '';\n                    }\n                    return '';\n                });\n                allRows.push([\n                    ...(includeCaseSubject ? [group.caseSubject || ''] : []),\n                    conn.studentName          || '',\n                    conn.studentFamiliarName   || '',\n                    conn.studentEmail          || '',\n                    ...(isCC ? [conn.studentPreSurveyCompleted ? 'Yes' : 'No'] : []),\n                    ...weekCols,\n                    conn.studentSurveyCompleted ? 'Yes' : 'No',\n                    studentLink\n                ]);\n            }\n        }\n\n        return allRows;\n    }\n\n    /** Trigger a browser CSV download. */\n    _triggerDownload(rows, fileName) {\n        const csvLines = rows.map(row =&gt;\n            row.map(cell =&gt; `\"${(cell || '').toString().replace(/\"/g, '\"\"')}\"`).join(',')\n        );\n        const csv     = csvLines.join('\\r\\n');\n        const encoded = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);\n        const link    = document.createElement('a');\n        link.setAttribute('href', encoded);\n        link.setAttribute('download', fileName);\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n    }\n\n    /** Download each case group as its own separate CSV file. */\n    _downloadSeparate() {\n        try {\n            const groups = this.displayGroups;\n            if (!groups || groups.length === 0) return;\n            const roleLabel = this.isMentorView ? 'Mentors' : 'Students';\n            for (const group of groups) {\n                const rows     = this._buildGroupRows(group, false);\n                const safeName = (group.caseSubject || 'Case').replace(/[^a-zA-Z0-9_\\- ]/g, '').trim().replace(/\\s+/g, '_');\n                this._triggerDownload(rows, `${safeName}_Overdue${roleLabel}.csv`);\n            }\n        } catch (err) {\n            console.error('CSV download error:', err);\n        }\n    }\n\n    /** Download all case groups into one combined CSV file with a Case Subject column. */\n    _downloadCombined() {\n        try {\n            const groups = this.displayGroups;\n            if (!groups || groups.length === 0) return;\n            const roleLabel = this.isMentorView ? 'Mentors' : 'Students';\n\n            // Build header from the first group, then data rows from all groups (skip per-group headers after first)\n            const allRows = [];\n            groups.forEach((group, idx) =&gt; {\n                const groupRows = this._buildGroupRows(group, true);\n                if (idx === 0) {\n                    // Include the header row only once\n                    allRows.push(...groupRows);\n                } else {\n                    // Skip the header row (index 0) for subsequent groups\n                    allRows.push(...groupRows.slice(1));\n                }\n            });\n\n            this._triggerDownload(allRows, `AllCases_Overdue${roleLabel}.csv`);\n        } catch (err) {\n            console.error('CSV download error:', err);\n        }\n    }\n\n    // \u2500\u2500 Date utilities \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    _today() {\n        const d = new Date();\n        d.setHours(0, 0, 0, 0);\n        return d;\n    }\n\n    _parseDate(val) {\n        if (!val) return null;\n        const str = typeof val === 'string' ? val : String(val);\n        const m   = str.match(/^(\\d{4})-(\\d{2})-(\\d{2})/);\n        if (!m) return null;\n        return new Date(Number(m[1]), Number(m[2]) - 1, Number(m[3]));\n    }\n\n    _parseDateTime(val) {\n        if (!val) return null;\n        return new Date(val);\n    }\n\n    _daysBetween(dateA, dateB) {\n        return Math.floor((dateB - dateA) / (1000 * 60 * 60 * 24));\n    }\n\n    _fmt(date) {\n        if (!date) return '\u2013';\n        return `${String(date.getMonth() + 1).padStart(2, '0')}/${String(date.getDate()).padStart(2, '0')}/${date.getFullYear()}`;\n    }\n\n    _fmtDateTime(val) {\n        if (!val) return '';\n        const d = typeof val === 'string' ? new Date(val) : val;\n        if (isNaN(d)) return '';\n        return this._fmt(d);\n    }\n}\n</code></pre></p>"},{"location":"mentoring/other_systems/portal_upload/","title":"Mentoring Portal Upload","text":"<p>Due to the high number of errors that were historically happening with Apsona portal uploads for every connection and the high cost of Apsona licenses, we have switched to a custom build integration that allows us to process portal uploads internally. The base of this system is a simple CSV file processor that parses the CSV content into rows, then creates / updates the contact for student and mentor first, creates the BestPrep Program Participation record and relates it to each contact respectively, then creates the Connection and links it to both the case and the student and mentor BPPPs. </p> <p>To reduce errors, the upload system has extremely strict data validation filters, as well as formatting data itself when mis-constructed. </p> <ul> <li>Names are always corrected to proper formatting <ul> <li>\"james\" would become \"James\"</li> <li>\"RUTHIE\" would become \"Ruthie\"</li> </ul> </li> <li>Any pronoun format that does not match the He/him/his or She/they/theirs format will be rejected with an error message</li> <li>Case ID must be valid</li> <li>All email addresses must be in the format user@domain.com and are formatted to all lower-case. </li> <li>Once a portal upload is completed, the option to do another portal upload for that case is disabled and must be done manually. </li> </ul>"},{"location":"mentoring/overview_portal/overview_apex/","title":"Mentoring Overview Portal Apex","text":""},{"location":"mentoring/overview_portal/overview_js/","title":"Overview JavaScript","text":""},{"location":"mentoring/overview_portal/overview_portal/","title":"Teacher and Coordinator Portal","text":"<p>The teacher and company coordinator overview portal is the replacement for what was previously sending an exported Salesforce report to teachers each week and company coordinators upon request. </p> <p>IMPORTANT NOTE: There are TWO different overview portals. There is the Connection Overview and the Connection Cloud. </p> <p>Connection Overview pulls its data from the child case. This would be used for an eMentors connection, or just a single specific Cloud Coach child case. However, the Connection Cloud pulls from the parent connection - and must use the case Id from the parent connection. It searches all related cases, pulls all their connections and messages, and then displays them in one place. </p> <p>Because of the fact that most Cloud Coach cases contain multiple companies, the Connection Cloud supports an additional URL tag \"orgName\" - orgName is a simple filter that looks for the data on the connection of the stripped ult parent organiation name. This means that as long as the social heiarchy is setup correctly in Salesforce, a mentor at \"Old National Bank\" and \"Bremer Bank\" should both have the same stripped ult parent org name - something like \"oldnationalbank\"</p> <p>The URLs for</p> <ul> <li>Apex Code</li> <li>JavaScript</li> <li>HTML &amp; CSS</li> </ul>"},{"location":"mentoring/overview_portal/overview_portal/#screenshots","title":"Screenshots","text":""},{"location":"mentoring/student_portal/student_apex/","title":"Student Apex","text":""},{"location":"mentoring/student_portal/student_js/","title":"Student JavaScript","text":""},{"location":"mentoring/student_portal/student_portal/","title":"Student Portal Overview","text":""}]}